<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="Content-Language" content="ru"></head><body><h1 class="V8SH_pagetitle">Automation сервер (Automation server)</h1><p class="V8SH_title">Automation сервер (Automation server)</p><div class="__SINCE_SHOW_STYLE__"><p class="not_used">Доступен, начиная с версии 8.2.</p></div><p class="V8SH_chapter">Свойства:</p><a href="Automation server/properties/Visible5768.html">Visible (Visible)</a><br><p class="V8SH_chapter">Методы:</p><a href="Automation server/methods/Connect2743.html">Connect (Connect)</a><br><a href="Automation server/methods/NewObject2745.html">NewObject (NewObject)</a><br><a href="Automation server/methods/String2746.html">String (String)</a><br><p class="V8SH_chapter">Описание:</p><p>Система 1С:Предприятие может использоваться внешними приложениями в качестве Automation-сервера. При работе в качестве Automation-сервера 1С:Предприятие предоставляет доступ ко всем свойствам и методам своего глобального контекста, а также включение и выключение пользовательского интерфейса (главного окна 1С:Предприятия 8). Кроме того, Automation-сервер 1С:Предприятия имеет дополнительные свойства и методы для выполнения действий, специфичных для работы в режиме Automation.<br>Основное назначение Automation-сервера 1С:Предприятие в управлении приложением 1С:Предприятия 8 из других приложений и выполнение действий аналогичных интерактивным действиям, например, построение отчетов.<br>Для запуска системы 1С:Предприятие в качестве Automation-сервера из внешнего приложения, выполняется следующая последовательность действий:<ul><li>создается COMОбъект с идентификатором V83.Application (для тонкого клиента V83C.Application);</li><li>выполняется инициализация системы 1С:Предприятие методом <a href="v8help://SyntaxHelperContext/objects/catalog1369/Automation server/methods/Connect2743.html">Connect</a> (для тонкого клиента существует возможность передать в строке соединения дополнительные параметры прокси сервера);</li><li>вызываются свойства и методы системы 1С:Предприятие как Automation-сервера.</li></ul>Многие современные программные продукты (MS Office, MS FoxPro и т.п.) могут выступать в роли клиентов Automation, что позволяет обмениваться данными между этими продуктами и системой 1С:Предприятие.<br>Замечание 1: Поскольку система 1С:Предприятие может создавать и использовать Automation-серверы, предоставляемые внешними приложениями (т.е. является Automation-клиентом), то имеется возможность из 1С:Предприятия обращаться к другой копии 1С:Предприятия (например, к другой конфигурации) для обмена данными.<br>Замечание 2: Нелокализованные версии внешних программ, обращающихся к программе 1С:Предприятие посредством Automation, могут неправильно интерпретировать русские идентификаторы объектов, например, реквизитов справочников. Данное замечание не относится к продуктам MS Office и к программам, использующим в качестве языка обращения к COM-объектам Microsoft Visual Basic. Рекомендуется использовать локализованные версии программных продуктов, либо в конфигурации использовать идентификаторы без символов кириллицы. Для обращения к свойствам и методам объектов системы 1С:Предприятие из внешних приложений рекомендуется использовать их англоязычные синонимы.<br>Замечание 3: Все созданные объекты Automation существуют до тех пор, пока существует переменная, которая содержит значение данного объекта. Следовательно, сама программа 1С:Предприятие, выступающая в качестве объекта Automation в другой программе, будет находиться в памяти компьютера до удаления или изменения значения переменной, содержащей ее в качестве объекта.<br>Система 1С:Предприятие в качестве Automation-сервера предоставляет полный доступ к своему глобальному контексту. Поэтому объект Automation-сервер 1С:Предприятие в качестве своих свойств может иметь: системные константы, значения заданных в Конфигураторе объектов, доступ к которым осуществляется с помощью менеджеров (например, константы, перечисления, справочники, документы, журналы документов, отчеты, обработки, планы видов характеристик, планы счетов, планы видов расчета, регистры), а также переменные, объявленные в модуле приложения (управляемого / обычного) с ключевым словом Экспорт.<br>Automation-сервер 1С:Предприятие в качестве своих методов может иметь: системные процедуры и функции, а также процедуры и функции модуля приложения и общих модулей, объявленные с ключевым словом Экспорт.</p><p class="V8SH_chapter">Доступность: </p><p>Интеграция.</p><p class="V8SH_chapter">Пример:</p><TABLE width="100%" bgColor="#f7f7f7"><TBODY><TR><TD><font face="Courier New"> <font color="#0000ff"><font color="#008000">//&nbsp;Пример1&nbsp;создания&nbsp;объекта<BR></font><BR>Соединитель&nbsp;<font color="#ff0000">=</font><font color="#ff0000">&nbsp;Новый&nbsp;</font>COMObject<font color="#ff0000">(</font><font color="#000000">"V83.Application"</font><font color="#ff0000">)</font><font color="#ff0000">;</font><BR><BR><font color="#008000">//&nbsp;Пример&nbsp;2<BR></font><BR><font color="#008000">//&nbsp;В&nbsp;данном&nbsp;примере&nbsp;запускается&nbsp;и&nbsp;инициализируется&nbsp;конфигурация&nbsp;<BR></font><BR><font color="#008000">//&nbsp;1С:Предприятие&nbsp;с&nbsp;базой&nbsp;данных&nbsp;в&nbsp;каталоге&nbsp;c:\InfoBases\Trade.&nbsp;<BR></font><BR><font color="#008000">//&nbsp;Далее&nbsp;в&nbsp;программе&nbsp;1С:Предприятие&nbsp;создается&nbsp;объект&nbsp;типа&nbsp;"Справочник.Товары",&nbsp;<BR></font><BR><font color="#008000">//&nbsp;где&nbsp;создается&nbsp;новая&nbsp;группа&nbsp;элементов&nbsp;с&nbsp;названием&nbsp;"*****&nbsp;Экспорт&nbsp;из&nbsp;Excel&nbsp;******".&nbsp;<BR></font><BR><font color="#008000">//&nbsp;Во&nbsp;вновь&nbsp;созданную&nbsp;группу&nbsp;каталога&nbsp;записываются&nbsp;данные&nbsp;из&nbsp;таблицы&nbsp;MS&nbsp;Excel.&nbsp;<BR></font><BR><font color="#008000">//&nbsp;Пример&nbsp;приводится&nbsp;на&nbsp;языке&nbsp;MS&nbsp;Visual&nbsp;Basic.<BR></font><BR><BR>Sub&nbsp;Excel_to_trade<font color="#ff0000">(</font><font color="#ff0000">)</font><BR>&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;trade&nbsp;As&nbsp;Object<BR>&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;Товар&nbsp;As&nbsp;Object<BR>&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;Группа&nbsp;As&nbsp;Object<BR>&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;Элемент&nbsp;As&nbsp;Object<BR>&nbsp;&nbsp;&nbsp;&nbsp;Set&nbsp;trade&nbsp;<font color="#ff0000">=</font>&nbsp;CreateObject<font color="#ff0000">(</font><font color="#000000">"V83.Application"</font><font color="#ff0000">)</font><BR>&nbsp;&nbsp;&nbsp;&nbsp;trade<font color="#ff0000">.</font>Connect<font color="#ff0000">(</font><font color="#000000">"File="</font><font color="#000000">"c:\InfoBases\Trade"</font><font color="#000000">";Usr="</font><font color="#000000">"Director"</font><font color="#000000">";"</font><font color="#ff0000">)</font><BR>&nbsp;&nbsp;&nbsp;&nbsp;Set&nbsp;Товар&nbsp;<font color="#ff0000">=</font>&nbsp;trade<font color="#ff0000">.</font>Справочники<font color="#ff0000">.</font>Товары<BR>&nbsp;&nbsp;&nbsp;&nbsp;Set&nbsp;Группа&nbsp;<font color="#ff0000">=</font>&nbsp;Товар<font color="#ff0000">.</font>СоздатьГруппу<font color="#ff0000">(</font><font color="#ff0000">)</font><BR>&nbsp;&nbsp;&nbsp;&nbsp;Группа<font color="#ff0000">.</font>Наименование&nbsp;<font color="#ff0000">=</font>&nbsp;<font color="#000000">"*****&nbsp;Экспорт&nbsp;из&nbsp;Excel&nbsp;******"</font><BR>&nbsp;&nbsp;&nbsp;&nbsp;Группа<font color="#ff0000">.</font>Записать<font color="#ff0000">(</font><font color="#ff0000">)</font><BR>&nbsp;&nbsp;&nbsp;&nbsp;N&nbsp;<font color="#ff0000">=</font><font color="#0000ff">&nbsp;100&nbsp;</font>&nbsp;&nbsp;'Количество&nbsp;строк&nbsp;в&nbsp;документе<BR><font color="#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;</font>Count&nbsp;<font color="#ff0000">=</font><font color="#0000ff">&nbsp;1&nbsp;</font><font color="#ff0000">To&nbsp;</font>N<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set&nbsp;Элемент&nbsp;<font color="#ff0000">=</font>&nbsp;Товар<font color="#ff0000">.</font>СоздатьЭлемент<font color="#ff0000">(</font><font color="#ff0000">)</font><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Элемент<font color="#ff0000">.</font>Наименование&nbsp;<font color="#ff0000">=</font>&nbsp;Application<font color="#ff0000">.</font>Cells<font color="#ff0000">(</font>Count<font color="#ff0000">,</font><font color="#000000">&nbsp;2</font><font color="#ff0000">)</font><font color="#ff0000">.</font>Value<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Элемент<font color="#ff0000">.</font>Розн_Цена&nbsp;<font color="#ff0000">=</font>&nbsp;Application<font color="#ff0000">.</font>Cells<font color="#ff0000">(</font>Count<font color="#ff0000">,</font><font color="#000000">&nbsp;3</font><font color="#ff0000">)</font><font color="#ff0000">.</font>Value<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Элемент<font color="#ff0000">.</font>Мел_Опт_Цена&nbsp;<font color="#ff0000">=</font>&nbsp;Application<font color="#ff0000">.</font>Cells<font color="#ff0000">(</font>Count<font color="#ff0000">,</font><font color="#000000">&nbsp;4</font><font color="#ff0000">)</font><font color="#ff0000">.</font>Value<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Элемент<font color="#ff0000">.</font>Опт_Цена&nbsp;<font color="#ff0000">=</font>&nbsp;Application<font color="#ff0000">.</font>Cells<font color="#ff0000">(</font>Count<font color="#ff0000">,</font><font color="#000000">&nbsp;5</font><font color="#ff0000">)</font><font color="#ff0000">.</font>Value<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Элемент<font color="#ff0000">.</font>Родитель&nbsp;<font color="#ff0000">=</font>&nbsp;Группа<font color="#ff0000">.</font>Ссылка<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Элемент<font color="#ff0000">.</font>Записать<font color="#ff0000">(</font><font color="#ff0000">)</font><BR>&nbsp;&nbsp;&nbsp;&nbsp;Next&nbsp;Count<BR>End&nbsp;Sub</font><BR></font></font></TD></TR></TBODY></TABLE><p class="V8SH_chapter">Использование в версии:</p><p class="V8SH_versionInfo">Доступен, начиная с версии 8.2.</p><HR><p>&nbsp;&nbsp;&nbsp;&nbsp; <a href=http://www.1centerprise.com/devlinks?C="id=00058O01383;lan=ru" target="_blank">Методическая информация</a></p></body></html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="Content-Language" content="ru"></head><body><h1 class="V8SH_pagetitle">Внешнее соединение (External connection)</h1><p class="V8SH_title">Внешнее соединение (External connection)</p><div class="__SINCE_SHOW_STYLE__"><p class="not_used">Доступен, начиная с версии 8.2.</p></div><p class="V8SH_chapter">Методы:</p><a href="External connection/methods/NewObject2744.html">NewObject (NewObject)</a><br><a href="External connection/methods/String2778.html">String (String)</a><br><p class="V8SH_chapter">Описание:</p><p>В общем и целом работа с 1С:Предприятием 8 через внешнее соединение подобна работе с 1С:Предприятием в режиме Automation сервера. Основные отличия заключаются в следующем:<ul><li>В случае Automation сервера запускается полноценное приложение 1С:Предприятия 8, а в случае внешнего соединения запускается относительно небольшой внутрипроцессный COM-сервер.</li><li>При работе через внешнее соединение не доступны функциональные возможности, так или иначе связанные с организацией пользовательского интерфейса 1С:Предприятия 8;</li><li>При работе внешнего соединения не используется модуль приложения (модуль обычного приложения) конфигурации 1С:Предприятия 8. Его роль при работе с внешним соединением играет модуль внешнего соединения.</li></ul>При использовании внешнего соединения имеются следующие преимущества по сравнению с использованием Automation сервера:<ul><li>Более быстрая установка соединения, так как не требуется создания отдельного процесса операционной системы, а все действия производятся в рамках вызывающего процесса;</li><li>Более быстрое обращение к свойствам и методам объектов 1C:Предприятия, так как для организации обращения не требуется организации межпроцессной коммуникации;</li><li>Меньший расход ресурсов операционной системы.</li></ul>Для организации доступа к данным 1С:Предприятия 8 через внешнее соединение, выполняется следующая последовательность действий:<ul><li>создается менеджер COM-соединений, с помощью которого производится установка соединения;</li><li>производится обращение к методу Connect менеджера COM-соединений. Метод Connect возвращает внешнее соединение с информационной базой 1С:Предприятия 8;</li><li>через внешнее соединение производится обращение к допустимым методам, свойствам и объектам информационной базы, с которой установлено соединение.</li></ul>Важно! В связи с отсутствием пользовательского интерфейса не все объекты, а также свойства и методы можно использовать во внешнем соединении. <br>Внешнее соединение предоставляет полный доступ к своему глобальному контексту. Поэтому внешнее соединение в качестве своих методов может иметь: системные константы, значения заданных в Конфигураторе объектов, доступ к которым осуществляется с помощью менеджеров (например, константы, перечисления, справочники, документы, журналы документов, отчеты, обработки, планы видов характеристик, планы счетов, планы видов расчета, регистры), а также переменные, объявленные в модуле внешнего соединения с ключевым словом Экспорт.</p><p class="V8SH_chapter">Доступность: </p><p>Интеграция.</p><p class="V8SH_chapter">Пример:</p><TABLE width="100%" bgColor="#f7f7f7"><TBODY><TR><TD><font face="Courier New"> <font color="#0000ff"><font color="#008000">//&nbsp;Создание&nbsp;объекта-коннектора<BR></font><BR>cntr&nbsp;<font color="#ff0000">=</font><font color="#ff0000">&nbsp;Новый&nbsp;</font>COMObject<font color="#ff0000">(</font><font color="#000000">"V83.COMConnector"</font><font color="#ff0000">)</font><font color="#ff0000">;</font><BR><font color="#008000">//&nbsp;создается&nbsp;объект&nbsp;COM-соединение<BR></font><BR>connection&nbsp;<font color="#ff0000">=</font>&nbsp;cntr<font color="#ff0000">.</font>Connect<font color="#ff0000">(</font><font color="#000000">"File="</font><font color="#000000">"c:\InfoBases\Trade"</font><font color="#000000">";Usr="</font><font color="#000000">"Director"</font><font color="#000000">";"</font><font color="#ff0000">)</font><font color="#ff0000">;</font><BR>СпрКонтрагенты&nbsp;<font color="#ff0000">=</font>&nbsp;connection<font color="#ff0000">.</font>Справочники<font color="#ff0000">.</font>Контрагенты<font color="#ff0000">;</font><BR>Выборка&nbsp;<font color="#ff0000">=</font>&nbsp;СпрКонтрагенты<font color="#ff0000">.</font>Выбрать<font color="#ff0000">(</font><font color="#ff0000">)</font><font color="#ff0000">;</font><font color="#ff0000"><BR>Пока&nbsp;</font>Выборка<font color="#ff0000">.</font>Следующий<font color="#ff0000">(</font><font color="#ff0000">)</font><font color="#ff0000">&nbsp;Цикл<BR></font>&nbsp;&nbsp;&nbsp;&nbsp;Сообщить<font color="#ff0000">(</font>Выборка<font color="#ff0000">.</font>Наименование<font color="#ff0000">)</font><font color="#ff0000">;</font><font color="#ff0000"><BR>КонецЦикла</font><font color="#ff0000">;</font><BR><BR><font color="#008000">//&nbsp;Пример&nbsp;на&nbsp;языке&nbsp;MS&nbsp;Visual&nbsp;Basic<BR></font><BR>Sub&nbsp;Excel_to_trade<font color="#ff0000">(</font><font color="#ff0000">)</font><BR>&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;cntr&nbsp;As&nbsp;Object<BR>&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;trade&nbsp;As&nbsp;Object<BR>&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;Товар&nbsp;As&nbsp;Object<BR>&nbsp;&nbsp;&nbsp;&nbsp;Set&nbsp;cntr&nbsp;<font color="#ff0000">=</font>&nbsp;CreateObject<font color="#ff0000">(</font><font color="#000000">"V83.COMConnector"</font><font color="#ff0000">)</font><BR>&nbsp;&nbsp;&nbsp;&nbsp;Set&nbsp;trade&nbsp;<font color="#ff0000">=</font>&nbsp;cntr<font color="#ff0000">.</font>Connect<font color="#ff0000">(</font><font color="#000000">"File="</font><font color="#000000">"c:\InfoBases\Trade"</font><font color="#000000">";&nbsp;Usr="</font><font color="#000000">"Director"</font><font color="#000000">";"</font><font color="#ff0000">)</font><BR>&nbsp;&nbsp;&nbsp;&nbsp;Set&nbsp;Товар&nbsp;<font color="#ff0000">=</font>&nbsp;trade<font color="#ff0000">.</font>Справочники<font color="#ff0000">.</font>Товары<BR>&nbsp;&nbsp;&nbsp;&nbsp;Группа&nbsp;<font color="#ff0000">=</font>&nbsp;Товар<font color="#ff0000">.</font>СоздатьГруппу<font color="#ff0000">(</font><font color="#ff0000">)</font><BR>&nbsp;&nbsp;&nbsp;&nbsp;Группа<font color="#ff0000">.</font>Наименование&nbsp;<font color="#ff0000">=</font>&nbsp;<font color="#000000">"*****&nbsp;Экспорт&nbsp;из&nbsp;Excel&nbsp;******"</font><BR>&nbsp;&nbsp;&nbsp;&nbsp;Группа<font color="#ff0000">.</font>Записать<font color="#ff0000">(</font><font color="#ff0000">)</font><BR>&nbsp;&nbsp;&nbsp;&nbsp;N&nbsp;<font color="#ff0000">=</font><font color="#0000ff">&nbsp;100&nbsp;</font>&nbsp;&nbsp;'Количество&nbsp;строк&nbsp;в&nbsp;документе<BR><font color="#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;</font>Count&nbsp;<font color="#ff0000">=</font><font color="#0000ff">&nbsp;1&nbsp;</font><font color="#ff0000">To&nbsp;</font>N<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Элемент&nbsp;<font color="#ff0000">=</font>&nbsp;Товар<font color="#ff0000">.</font>СоздатьЭлемент<font color="#ff0000">(</font><font color="#ff0000">)</font><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Элемент<font color="#ff0000">.</font>Наименование&nbsp;<font color="#ff0000">=</font>&nbsp;Application<font color="#ff0000">.</font>Cells<font color="#ff0000">(</font>Count<font color="#ff0000">,</font><font color="#000000">&nbsp;2</font><font color="#ff0000">)</font><font color="#ff0000">.</font>Value<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Элемент<font color="#ff0000">.</font>Розн_Цена&nbsp;<font color="#ff0000">=</font>&nbsp;Application<font color="#ff0000">.</font>Cells<font color="#ff0000">(</font>Count<font color="#ff0000">,</font><font color="#000000">&nbsp;3</font><font color="#ff0000">)</font><font color="#ff0000">.</font>Value<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Элемент<font color="#ff0000">.</font>Мел_Опт_Цена&nbsp;<font color="#ff0000">=</font>&nbsp;Application<font color="#ff0000">.</font>Cells<font color="#ff0000">(</font>Count<font color="#ff0000">,</font><font color="#000000">&nbsp;4</font><font color="#ff0000">)</font><font color="#ff0000">.</font>Value<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Элемент<font color="#ff0000">.</font>Опт_Цена&nbsp;<font color="#ff0000">=</font>&nbsp;Application<font color="#ff0000">.</font>Cells<font color="#ff0000">(</font>Count<font color="#ff0000">,</font><font color="#000000">&nbsp;5</font><font color="#ff0000">)</font><font color="#ff0000">.</font>Value<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Элемент<font color="#ff0000">.</font>Родитель&nbsp;<font color="#ff0000">=</font>&nbsp;Группа<font color="#ff0000">.</font>Ссылка<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Элемент<font color="#ff0000">.</font>Записать<font color="#ff0000">(</font><font color="#ff0000">)</font><BR>&nbsp;&nbsp;&nbsp;&nbsp;Next&nbsp;Count<BR>End&nbsp;Sub</font><BR></font></font></TD></TR></TBODY></TABLE><p class="V8SH_chapter">См. также:</p><a href="v8help://SyntaxHelperContext/objects/catalog1369/catalog1384/catalog1386/IWorkingProcessConnection.html">Соединение с рабочим процессом</a>, метод <a href="v8help://SyntaxHelperContext/objects/catalog1369/catalog1384/catalog1386/IWorkingProcessConnection/methods/Connect2733.html">Connect</a><br><a href="v8help://SyntaxHelperContext/objects/catalog1369/catalog1384/COM connector.html">Менеджер COM-соединений</a>, метод <a href="v8help://SyntaxHelperContext/objects/catalog1369/catalog1384/COM connector/methods/Connect2740.html">Connect</a><br><a href="v8help://SyntaxHelperContext/objects/Global context.html">Глобальный контекст</a>, метод <a href="v8help://SyntaxHelperContext/objects/Global context/methods/catalog33/GetUserMessages3583.html">ПолучитьСообщенияПользователю</a><br><p class="V8SH_chapter">Использование в версии:</p><p class="V8SH_versionInfo">Доступен, начиная с версии 8.2.</p><HR><p>&nbsp;&nbsp;&nbsp;&nbsp; <a href=http://www.1centerprise.com/devlinks?C="id=00058O01387;lan=ru" target="_blank">Методическая информация</a></p></body></html>
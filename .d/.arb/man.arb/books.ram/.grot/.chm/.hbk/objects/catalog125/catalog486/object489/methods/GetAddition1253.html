<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="Content-Language" content="ru"></head><body><h1 class="V8SH_pagetitle">РегистрРасчетаНаборЗаписей.&lt;Имя регистра расчета&gt;.ПолучитьДополнение (CalculationRegisterRecordSet.&lt;Calculation register name&gt;.GetAddition)</h1><p class="V8SH_title">РегистрРасчетаНаборЗаписей.&lt;Имя регистра расчета&gt; (CalculationRegisterRecordSet.&lt;Calculation register name&gt;)</p><p class="V8SH_heading">ПолучитьДополнение (GetAddition)</p><div class="__SINCE_SHOW_STYLE__"><p class="not_used">Доступен, начиная с версии 8.0.</p></div><p class="V8SH_chapter">Синтаксис:</p>ПолучитьДополнение()<p class="V8SH_chapter">Возвращаемое значение:</p>Тип: <a href="v8help://SyntaxHelperContext/objects/catalog234/catalog236/ValueTable.html">ТаблицаЗначений</a>. <br><p class="V8SH_chapter">Описание:</p><p>Получает дополнительные данные, позволяющие выполнить сторнирование записей прошлых периодов регистрации при вводе текущего набора записей. Данные получаются в виде таблицы значений со следующей структурой: все предопределенные поля записи регистра расчета кроме регистратора и номера записи, все измерения, ресурсы и реквизиты, а также дополнительные поля - период регистрации сторнирования, дата начала сторнирования и дата окончания сторнирования.<br>Дополнение - это данные, которые система "предлагает" добавить в текущий набор записей для того, чтобы текущие записи набора в результате сохранения имели максимальный фактический период действия за счет сторнирования (если это необходимо) записей прошлых периодов регистрации. Предлагаемые дополнительные сторно-записи формируются на основании периодов действия записей регистра расчета и правил конкуренции за период действия, задаваемых списками вытесняемых видов расчета в плане видов расчета регистра.<br>Необходимость получить дополнение возникает при попытке ввести учетную запись с периодом действия, который уже "занят" введенной ранее учетной записью, период регистрации которой меньше, чем период регистрации вводимой учетной записи.<br>В полученной таблице значений поля заполнены данными сторнируемых записей (уже существующих в регистре расчета) и, кроме того, дополнительными данными: период регистрации сторно - период регистрации, в котором система рекомендует зарегистрировать сторно-запись, дата начала и дата окончания периода сторнирования - период, который система рекомендует ввести в качестве периода действия сторно-записи.</p><p class="V8SH_chapter">Доступность: </p><p>Сервер, толстый клиент, внешнее соединение.</p><p class="V8SH_chapter">Пример:</p><TABLE width="100%" bgColor="#f7f7f7"><TBODY><TR><TD><font face="Courier New"> <font color="#0000ff"><font color="#008000">//&nbsp;код&nbsp;располагается&nbsp;в&nbsp;модуле&nbsp;документа<BR></font><BR>РегистрНачисления&nbsp;<font color="#ff0000">=</font>&nbsp;<font color="#000000">"ОсновныеНачисленияСотрудниковОрганизаций"</font><font color="#ff0000">;</font><BR><BR>Запрос&nbsp;<font color="#ff0000">=</font><font color="#ff0000">&nbsp;Новый&nbsp;</font>Запрос<font color="#ff0000">;</font><BR><font color="#008000">//&nbsp;Установим&nbsp;параметры&nbsp;запроса<BR></font><BR>Запрос<font color="#ff0000">.</font>УстановитьПараметр<font color="#ff0000">(</font><font color="#000000">"ДокументСсылка"</font>&nbsp;<font color="#ff0000">,</font>&nbsp;Ссылка<font color="#ff0000">)</font><font color="#ff0000">;</font><BR><BR>Запрос<font color="#ff0000">.</font>Текст&nbsp;<font color="#ff0000">=</font>&nbsp;<font color="#000000">"<BR>|ВЫБРАТЬ&nbsp;<BR>|&nbsp;&nbsp;&nbsp;&nbsp;Дата,&nbsp;<BR>|&nbsp;&nbsp;&nbsp;&nbsp;ПериодРегистрации,&nbsp;<BR>|&nbsp;&nbsp;&nbsp;&nbsp;Организация,&nbsp;<BR>|&nbsp;&nbsp;&nbsp;&nbsp;Ссылка&nbsp;<BR>|ИЗ&nbsp;<BR>|&nbsp;&nbsp;&nbsp;&nbsp;Документ."</font>&nbsp;<font color="#ff0000">+</font>&nbsp;Метаданные<font color="#ff0000">(</font><font color="#ff0000">)</font><font color="#ff0000">.</font>Имя&nbsp;<font color="#ff0000">+</font>&nbsp;<font color="#000000">"<BR>|ГДЕ&nbsp;<BR>|&nbsp;&nbsp;&nbsp;&nbsp;Ссылка&nbsp;=&nbsp;&ДокументСсылка<BR>|"</font><font color="#ff0000">;</font><BR><BR>ВыборкаПоШапкеДокумента&nbsp;<font color="#ff0000">=</font>&nbsp;Запрос<font color="#ff0000">.</font>Выполнить<font color="#ff0000">(</font><font color="#ff0000">)</font><font color="#ff0000">.</font>Выбрать<font color="#ff0000">(</font><font color="#ff0000">)</font><font color="#ff0000">;</font><BR>Выборка&nbsp;<font color="#ff0000">=</font>&nbsp;СформироватьЗапросПоНалогам<font color="#ff0000">(</font><font color="#ff0000">)</font><font color="#ff0000">.</font>Выбрать<font color="#ff0000">(</font><font color="#ff0000">)</font><font color="#ff0000">;</font><font color="#ff0000"><BR>Пока&nbsp;</font>Выборка<font color="#ff0000">.</font>Следующий<font color="#ff0000">(</font><font color="#ff0000">)</font><font color="#ff0000">&nbsp;Цикл&nbsp;</font><BR>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//&nbsp;проверим&nbsp;очередную&nbsp;строку&nbsp;табличной&nbsp;части<BR></font><BR>&nbsp;&nbsp;&nbsp;&nbsp;ПроверкаЗаполнения<font color="#ff0000">(</font>ВыборкаПоШапкеДокумента<font color="#ff0000">,</font>&nbsp;Выборка<font color="#ff0000">,</font>&nbsp;Отказ<font color="#ff0000">)</font><font color="#ff0000">;</font><font color="#ff0000"><BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;Если&nbsp;</font><font color="#ff0000">НЕ&nbsp;</font>Отказ&nbsp;<font color="#ff0000">Тогда<BR></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//&nbsp;зарегистрируем&nbsp;в&nbsp;регистре&nbsp;сведений<BR></font><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Движение&nbsp;<font color="#ff0000">=</font>&nbsp;Движения<font color="#ff0000">.</font>НДФЛИсчисленный13<font color="#ff0000">.</font>Добавить<font color="#ff0000">(</font><font color="#ff0000">)</font><font color="#ff0000">;</font><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//&nbsp;формирование&nbsp;свойств<BR></font><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//&nbsp;...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR></font><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//&nbsp;формирование&nbsp;измерений<BR></font><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//&nbsp;...<BR></font><BR><font color="#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;КонецЕсли</font><font color="#ff0000">;</font><font color="#ff0000"><BR>КонецЦикла</font><font color="#ff0000">;</font><font color="#ff0000"><BR><BR>Если&nbsp;</font><font color="#ff0000">НЕ&nbsp;</font>Отказ&nbsp;<font color="#ff0000">Тогда<BR></font>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//&nbsp;Получим&nbsp;дополнительные&nbsp;записи,&nbsp;имеющие&nbsp;признак&nbsp;сторно,&nbsp;&nbsp;<BR></font><BR>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//&nbsp;которые&nbsp;необходимо&nbsp;добавить&nbsp;в&nbsp;текущий&nbsp;набор&nbsp;для&nbsp;того,&nbsp;&nbsp;<BR></font><BR>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//&nbsp;чтобы&nbsp;в&nbsp;результате&nbsp;сохранения&nbsp;получился&nbsp;максимальный&nbsp;<BR></font><BR>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//&nbsp;фактический&nbsp;период&nbsp;действия<BR></font><BR>&nbsp;&nbsp;&nbsp;&nbsp;СторноЗаписи&nbsp;<font color="#ff0000">=</font>&nbsp;Движения<font color="#ff0000">[</font>РегистрНачисления<font color="#ff0000">]</font><font color="#ff0000">.</font>ПолучитьДополнение<font color="#ff0000">(</font><font color="#ff0000">)</font><font color="#ff0000">;</font><font color="#ff0000"><BR>&nbsp;&nbsp;&nbsp;&nbsp;Для&nbsp;</font><font color="#ff0000">каждого&nbsp;</font>Строка&nbsp;<font color="#ff0000">Из&nbsp;</font>СторноЗаписи&nbsp;<font color="#ff0000">Цикл<BR></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Движение&nbsp;<font color="#ff0000">=</font>&nbsp;Движения<font color="#ff0000">[</font>ИмяРегистра<font color="#ff0000">]</font><font color="#ff0000">.</font>Добавить<font color="#ff0000">(</font><font color="#ff0000">)</font><font color="#ff0000">;</font><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//&nbsp;формирование&nbsp;свойств<BR></font><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Движение<font color="#ff0000">.</font>Регистратор&nbsp;<font color="#ff0000">=</font>&nbsp;ВыборкаПоШапкеДокумента<font color="#ff0000">.</font>Ссылка<font color="#ff0000">;</font><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//&nbsp;...<BR></font><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//&nbsp;формирование&nbsp;измерений<BR></font><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//&nbsp;...<BR></font><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//&nbsp;формирование&nbsp;ресурсов<BR></font><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//&nbsp;...<BR></font><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//&nbsp;формирование&nbsp;реквизитов<BR></font><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Движение<font color="#ff0000">.</font>График&nbsp;<font color="#ff0000">=</font>&nbsp;Строка<font color="#ff0000">.</font>График<font color="#ff0000">;</font><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Движение<font color="#ff0000">.</font>Размер&nbsp;<font color="#ff0000">=</font>&nbsp;Строка<font color="#ff0000">.</font>Размер<font color="#ff0000">;</font><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//&nbsp;...<BR></font><BR><font color="#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;КонецЦикла</font><font color="#ff0000">;</font><font color="#ff0000"><BR>КонецЕсли</font><font color="#ff0000">;</font><BR><font color="#008000">//&nbsp;записать&nbsp;сформированные&nbsp;движения<BR></font><BR>НаборДвиженийРегистра&nbsp;<font color="#ff0000">=</font>&nbsp;Движения<font color="#ff0000">[</font>РегистрНачисления<font color="#ff0000">]</font><font color="#ff0000">;</font><BR>НаборДвиженийРегистра<font color="#ff0000">.</font>Записать<font color="#ff0000">(</font><font color="#ff0000">)</font><font color="#ff0000">;</font></font><BR></font></font></TD></TR></TBODY></TABLE><p class="V8SH_chapter">См. также:</p><a href="v8help://SyntaxHelperContext/objects/catalog125/catalog474/object477.html">ПланВидовРасчетаОбъект.&lt;Имя плана видов расчета&gt;</a>, свойство <a href="v8help://SyntaxHelperContext/objects/catalog125/catalog474/object477/properties/DisplacingCalculationTypes2023.html">ВытесняющиеВидыРасчета</a><br><p class="V8SH_chapter">Использование в версии:</p><p class="V8SH_versionInfo">Доступен, начиная с версии 8.0.</p><HR><p>&nbsp;&nbsp;&nbsp;&nbsp; <a href=http://www.1centerprise.com/devlinks?C="id=00058O00489M01253;lan=ru" target="_blank">Методическая информация</a></p></body></html>
<html>
<meta http-equiv=Content-Type content="text/html; charset=windows-1251">
<head>
<link rel="stylesheet" type="text/css" href="1c.css">
<title>Part35</title>
</head><body><script language="javascript">
if (window.name != "content")
    document.write("<center><a href='index.html?page=Part35.html'>show framing</a></center>")
</script>
<h1><a name="_Toc492735317"></a><a name="_Toc494938206"><span style='mso-bookmark: _Toc492735317'>Глава 35<br> Работа с Картинками</a></h1>

<p class=MsoNormal>При формировании пользовательского интерфейса
прикладной задачи ино­гда требуется отображать в диалоговых формах и печатных
документах графи­ческие файлы. Для этого в системе 1С:Предприятие используется
специальный агрегатный тип данных — <i>Картинка</i> и специальнй элемент формы
диалога и таблицы: «Картинка».</p>

<p class=MsoNormal>Одним из примеров использования данного
объекта может служить диало­говая форма справочника «Сотрудники» в которой при
выборе сотрудника ото­бражается его фотография.</p>

<h2><a name="_Toc492735318"></a><a name="_Toc494938207"><span style='mso-bookmark:
_Toc492735318'>Контекст работы с картинками</a></h2>

<p class=MsoNormal>Если в форму диалога или в таблицу при помощи
визуальных средств кон­фигуратора вставлены элементы формы типа «Картинка», система
автоматиче­ски создает объекты этого типа, причем идентификаторы этих элементов
дос­тупны в контексте программного модуля этой формы как уже существующие
объекты типа «Картинка». Кроме того, в программных модулях допускается
создавать произвольное число объектов типа «Картинка» просто при помощи вызова
системной функции <span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>СоздатьОбъект<span
lang=RU>.</p>

<p class=MsoNormal>При создании объекта типа «Картинка» при
помощи функции <span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>СоздатьОбъект<span
lang=RU>, в качестве названия агрегатного типа данных обязательно должно
выступать ключевое слово <span class=a0><span lang=RU style='font-family:
"Courier New";mso-bidi-font-family:"Times New Roman"'>Картинка<span
lang=RU>.</p>

<p class=MsoNormal>Англоязычный синоним ключевого слова <span
class=a0><span lang=RU style='font-family:"Courier New";mso-bidi-font-family:
"Times New Roman"'>Картинка — <span
class=a0><span lang=RU style='font-family:"Courier New";mso-bidi-font-family:
"Times New Roman"'>Picture.</p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Пример:</b></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>Фото=СоздатьОбъект(&quot;Картинка&quot;);<o:p></o:p></p>

<h3><a name="_Toc492735319"></a><a name="_Toc494938208"><span style='mso-bookmark:
_Toc492735319'>Методы объекта Картинка</a></h3>

<h4><a name="_Toc492735320"></a><a name="_Toc494938209"><span style='mso-bookmark:
_Toc492735320'>Загрузить</a></h4>

<p class=MsoNormal>Загрузить из файла.</p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Синтаксис:</b></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>Загрузить(&lt;ИмяФайла&gt;)<o:p></o:p></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Англоязычный
синоним:</b></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>Load<o:p></o:p></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Параметры:</b></p>

<table border=0 cellspacing=0 cellpadding=0 style='margin-left:17.4pt;
 border-collapse:collapse;mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td width=120 valign=top style='width:1.25in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-indent:0in'>&lt;<span
  class=a0><span lang=RU style='font-family:"Courier New";mso-bidi-font-family:
  "Times New Roman"'>ИмяФaйлa&gt;<o:p></o:p></p>
  </td>
  <td width=552 valign=top style='width:413.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-indent:0in'>Строковое выражение,
  которое может задавать или идентификатор картинки в библиотеке картинок
  конфигурации или имя файла картинки.</p>
  </td>
 </tr>
</table>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Описание:</b></p>

<p class=MsoNormal>Метод <span class=a0><span lang=RU
style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>Загрузить<span
lang=RU> загружает картинку из файла с указанным именем &lt;<span
class=a0><span lang=RU style='font-family:"Courier New";mso-bidi-font-family:
"Times New Roman"'>ИмяФайла&gt; или берет по
идентификатору картинку из библиотеки картинок конфигураци. Файл может быть
следующих форматов:</p>

<table border=0 cellspacing=0 cellpadding=0 style='margin-left:17.4pt;
 border-collapse:collapse;mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td width=88 valign=top style='width:66.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-indent:0in'><span style='mso-ansi-language:
  EN-US'>.wmf<o:p></o:p></p>
  </td>
  <td width=88 valign=top style='width:66.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-indent:0in'><span style='mso-ansi-language:
  EN-US'>.emf<o:p></o:p></p>
  </td>
  <td width=88 valign=top style='width:66.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-indent:0in'><span style='mso-ansi-language:
  EN-US'>.ico<o:p></o:p></p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-indent:0in'>.<span
  style='mso-ansi-language:EN-US'>bmp</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-indent:0in'>.<span
  style='mso-ansi-language:EN-US'>dib</p>
  </td>
  <td width=88 valign=top style='width:66.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-indent:0in'>.<span
  style='mso-ansi-language:EN-US'>rle</p>
  </td>
 </tr>
</table>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Пример:</b></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>Фото =
СоздатьОбъект(&quot;Картинка&quot;);<o:p></o:p></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>Фото.Загрузить(&quot;с:\BMP\Boris.bmp&quot;);<o:p></o:p></p>

<h4><a name="_Toc492735321"></a><a name="_Toc494938210"><span style='mso-bookmark:
_Toc492735321'>Сохранить</a></h4>

<p class=MsoNormal>Сохранить в файл.</p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Синтаксис:</b></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>Сохранить(&lt;ИмяФайла&gt;)<o:p></o:p></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Англоязычный
синоним:</b></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>Save<o:p></o:p></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Параметры:</b></p>

<table border=0 cellspacing=0 cellpadding=0 style='margin-left:11.4pt;
 border-collapse:collapse;mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td width=136 valign=top style='width:102.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-indent:0in'>&lt;<span
  class=a0><span lang=RU style='font-family:"Courier New";mso-bidi-font-family:
  "Times New Roman"'>ИмяФайла&gt;</p>
  </td>
  <td width=544 valign=top style='width:407.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-indent:0in'>Строковое выражение
  — имя файла.</p>
  </td>
 </tr>
</table>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Описание:</b></p>

<p class=MsoNormal>Метод <span class=a0><span lang=RU
style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>Сохранить<span
lang=RU> выгружает картинку в файл с именем &lt;<span class=a0><span
lang=RU style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>ИмяФайла<span
lang=RU>&gt; в формате загрузки (загрузили в формате <span
style='mso-ansi-language:EN-US'>bmp — в этом формате и
сохраним).</p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Пример:</b></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>Фото.Загрузить(&quot;с:\ВМР\Boris.bmp&quot;);<o:p></o:p></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>Фото.Сохранить(&quot;с:\lCv7\DBmy\Boris.bmp&quot;);<o:p></o:p></p>

<h4><a name="_Toc492735322"></a><a name="_Toc494938211"><span style='mso-bookmark:
_Toc492735322'>РежимРисования</a></h4>

<p class=MsoNormal>Установить режим рисования картинки.</p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Синтаксис:</b></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>РежимРисования(<span
class=a0><span style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman";
mso-ansi-language:EN-US'>&lt;<span class=a0><span lang=RU
style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>Режим&gt;)<o:p></o:p></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Англоязычный
синоним:</b></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>SetDrawMode<o:p></o:p></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Параметры:</b></p>

<table border=0 cellspacing=0 cellpadding=0 style='margin-left:17.4pt;
 border-collapse:collapse;mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td width=88 valign=top style='width:66.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-indent:0in'>&lt;<span
  class=a0><span lang=RU style='font-family:"Courier New";mso-bidi-font-family:
  "Times New Roman"'>Режим&gt;</p>
  </td>
  <td width=584 valign=top style='width:437.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-indent:0in'>Числовое выражение:
  1 — растягивать; 2 — рисовать по центру с оригинальным размером; 3 — рисовать
  сохраняя оригинальное соотношение высоты и ши­рины.</p>
  </td>
 </tr>
</table>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Возвращаемое
значение:</b></p>

<p class=MsoNormal>Текущее числовое значение режима рисования
картинки (на момент до ис­полнения метода).</p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Описание:</b></p>

<p class=MsoNormal>Метод <span class=a0><span lang=RU
style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>РежимРисования<span
lang=RU> устанавливает режим рисования картинки.</p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Пример:</b></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>Фото.РежимРисования(2);<o:p></o:p></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>Фото.Загрузить(&quot;с:\lCv7\DB<span
class=a0><span style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman";
mso-ansi-language:EN-US'>m<span class=a0><span lang=RU
style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>y\Boris.bmp&quot;);<o:p></o:p></p>

<h4><a name="_Toc492735323"></a><a name="_Toc494938212"><span style='mso-bookmark:
_Toc492735323'>УстановитьКартинку</a></h4>

<p class=MsoNormal>Переустановить объект типа
&quot;Картинка&quot;.</p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Синтаксис:</b></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>УстановитьКартинку(&lt;Объект&gt;)<o:p></o:p></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Англоязычный
синоним:</b></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>SetPicture<o:p></o:p></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Параметры:</b></p>

<table border=0 cellspacing=0 cellpadding=0 style='margin-left:17.4pt;
 border-collapse:collapse;mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td width=104 valign=top style='width:78.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-indent:0in'>&lt;<span
  class=a0><span lang=RU style='font-family:"Courier New";mso-bidi-font-family:
  "Times New Roman"'>Объект&gt;</p>
  </td>
  <td width=568 valign=top style='width:425.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-indent:0in'>Выражение, имеющее
  значение оъекта типа «Картин­ка» встроенного языка или OLE-объект типа <span
  style='mso-ansi-language:EN-US'>I <span style='mso-ansi-language:EN-US'>Picture<span
  lang=RU>.</p>
  </td>
 </tr>
</table>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Описание:</b></p>

<p class=MsoNormal>Метод <span class=a0><span lang=RU
style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>УстановитьКартинку<span
lang=RU> переписывает (копирует) значение источни­ка &lt;<span class=a0><span
lang=RU style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>Объект<span
lang=RU>&gt; в текущий объект. (Данный метод копирует все содержимое од­ного
объекта в другой, в отличие от оператора присваивания (=), который пе­редает
значение ссылки на уже существующий объект). Например:</p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>А =
СоздатьОбъект(&quot;Картинка&quot;);<o:p></o:p></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>В = А;<o:p></o:p></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>// в этом случае переменные А и В
ссылаются на один и тот же объект<o:p></o:p></p>

<p class=MsoNormal>Рассмотрим другой вариант:</p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>А =
СоздатьОбъект(&quot;Картинка&quot;);<o:p></o:p></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>В = СоздатьОбъект(&quot;Картинка&quot;);<o:p></o:p></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>А.Загрузить(&quot;с:\BMP\Boris.bmp&quot;);<o:p></o:p></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>В.УстановитьКартинку(А);<o:p></o:p></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>// в этом случае переменные А и В
ссылаются на два<o:p></o:p></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>// разных объекта, хотя и содержат одно
и то же<o:p></o:p></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Пример:</b></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>// Допустим в Форме диалога у нас есть
элемент типа картинка<o:p></o:p></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>// с идентификатором Кино.<o:p></o:p></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>// Сделаем анимацию изображения в этой
форме<o:p></o:p></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>Перем фото[5];<o:p></o:p></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>// создадим объекты и загрузим в них
картинки<o:p></o:p></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>Для Н = 1 По 5 Цикл<o:p></o:p></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'><span style="mso-spacerun: yes">  
Фото[Н] = СоздатьОбъект(&quot;Картинка&quot;);<o:p></o:p></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'><span style="mso-spacerun: yes">  
Фото[Н].Загрузить(&quot;с:\BMP\Foto&quot; + Строка(Н)+
&quot;.bmp&quot;);<o:p></o:p></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>КонецЦикла;<o:p></o:p></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>// Теперь запустим анимацию<o:p></o:p></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>Для Раз = 1 По 100 Цикл<o:p></o:p></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'><span style="mso-spacerun: yes">  
Для Н = 1 По 5 Цикл<o:p></o:p></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'><span style="mso-spacerun: yes">     
Кино.УстановитьКартинку(Фото[H]);<o:p></o:p></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'><span style="mso-spacerun: yes">  
КонецЦикла;<o:p></o:p></p>

<p class=MsoNormal><span class=a0><span lang=RU style='font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>КонецЦикла;<o:p></o:p></p>

<b style='mso-bidi-font-weight:normal'><span lang=RU style='font-size:14.0pt;
mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:"Times New Roman";
mso-bidi-font-family:"Times New Roman";mso-font-kerning:14.0pt;mso-ansi-language:
RU;mso-fareast-language:RU;mso-bidi-language:AR-SA;layout-grid-mode:line'><br
clear=all style='page-break-before:always'>
</b>

</body></html>

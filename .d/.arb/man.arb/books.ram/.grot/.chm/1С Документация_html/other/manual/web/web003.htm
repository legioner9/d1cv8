
<html>
<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1251">
<title>1С-Предприятие. Документация | Web-расширение. Часть 3</title>
<link rel="stylesheet" type="text/css" href="../../../1c.css">
</head>
<body lang=RU link=#0000FF vlink=#800080 background="../../../images/background_main.gif">
<h1 class="highlink"><font size="4">Web-расширение. 
  Часть 3.</font></h1>
<hr>
<p><b><a
href="#_toc497075651">Пример Web-приложения «Портал реализатора»</a> </b> </p>
<ul>
  <li> 
    <a
href="#_toc497075652">Конфигурация</a></li>
  <li> 
    <a
href="#_toc497075653">Контроль работы с порталом</a></li>
  <li> 
    <a
href="#_toc497075654">Режимы работы портала </a><ul>
      <li> 
        <a
href="#_toc497075654">Информация</a></li>
      <li> 
        <a
href="#_toc497075655">Список заказов</a></li>
      <li> 
        <a
href="#_toc497075656">Данные о реализации</a></li>
      <li> 
        <a
href="#_toc497075657">Список реализации</a></li>
      <li> 
        <a
href="#_toc497075658">Инвентаризация</a></li>
      <li> 
        <a
href="#_toc497075659">Список инвентаризаций</a></li>
      <li> 
        <a
href="#_toc497075660">Отчет о расчетах по реализации</a></li>
      <li> 
        <a
href="#_toc497075661">Отчеты о реализации</a></li>
      <li> 
        <a
href="#_toc497075662">Прайс-лист</a></li>
    </ul>
  </li>
  <li> 
    <a
href="#_toc497075663">Страницы портала</a><ul>
      <li> 
        <a
href="#_toc497075664">Общие страницы</a><ul>
          <li> 
            <a
href="#_toc497075665">Common.css</a></li>
          <li> 
            <a
href="#_toc497075666">Global.asa</a></li>
          <li> 
            <a
href="#_toc497075667">Main.asp (frameset)</a></li>
          <li> 
            <a
href="#_toc497075668">Menu.htm</a></li>
          <li> 
            <a
href="#_toc497075669">Default.asp</a></li>
          <li> 
            <a
href="#_toc497075670">Exit.asp</a></li>
        </ul>
      </li>
      <li> 
        <a
href="#_toc497075671">Информация</a><ul>
          <li> 
            <a
href="#_toc497075672">Info.asp</a></li>
        </ul>
      </li>
      <li> 
        <a
href="#_toc497075673">Заказ</a><ul>
          <li> 
            <a
href="#_toc497075674">Order.asp</a></li>
          <li> 
            <a
href="#_toc497075675">Ord_Cat.asp</a></li>
          <li> 
            <a
href="#_toc497075676">Ord_FG.asp</a></li>
          <li> 
            <a
href="#_toc497075677">Ord_Item.asp</a></li>
          <li> 
            <a
href="#_toc497075678">Ord_List.asp</a></li>
        </ul>
      </li>
      <li> 
        <a
href="#_toc497075679">Данные о реализации</a><ul>
          <li> 
            <a
href="#_toc497075680">Sale. asp</a></li>
          <li> 
            <a
href="#_toc497075681">SalJList.asp</a></li>
        </ul>
      </li>
      <li> 
        <a
href="#_toc497075682">Инвентаризация</a><ul>
          <li> 
            <a
href="#_toc497075683">Inventor, asp</a></li>
          <li> 
            <a
href="#_toc497075684">Inv_List.asp</a></li>
        </ul>
      </li>
      <li> 
        <a
href="#_toc497075685">Отчет о расчетах по реализации</a><ul>
          <li> 
            <a
href="#_toc497075686">CFA.asp</a></li>
          <li> 
            <a
href="#_toc497075687">CFAJSet.asp</a></li>
          <li> 
            <a
href="#_toc497075688">CFA_Data.asp</a></li>
        </ul>
      </li>
      <li> 
        <a
href="#_toc497075689">Отчет о реализации</a><ul>
          <li> 
            <a
href="#_toc497075690">Report.asp</a></li>
          <li> 
            <a
href="#_toc497075691">Rep_Set.asp</a></li>
          <li> 
            <a
href="#_toc497075692">RepJData.asp</a></li>
          <li> 
            <a
href="#_toc497075693">Price.asp</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li> 
    <a
href="#_toc497075694">Модуль сессии</a></li>
  <li> 
    <a
href="#_toc497075695">Используемые приемы программирования </a><ul>
      <li> 
        <a
href="#_toc497075695">Фреймы</a></li>
      <li> 
        <a
href="#_toc497075696">Вызовы функций с других страниц</a></li>
      <li> 
        <a
href="#_toc497075697">Передача параметров между страницами</a></li>
      <li> 
        <a
href="#_toc497075698">Навигация по справочнику</a></li>
      <li> 
        <a
href="#_toc497075699">Выбор из справочника</a></li>
      <li> 
        <a
href="#_toc497075700">Выбор из списка документов</a></li>
      <li> 
        <a
href="#_toc497075701">Использование табличных документов для генерации HTML-страниц</a></li>
      <li> 
        <a
href="#_toc497075702">Управление созданием таблицы</a></li>
      <li> 
        <a
href="#_toc497075703">Приемы JavaScrip</a></li>
    </ul>
  </li>
</ul>
<hr>
 
  <h2><a name="_Toc497075651">Пример </a>Web-приложения «Портал реализатора»</h2>

  <p style='
text-autospace:none'>Портал     реализатора     является     Web-приложением, 
    обеспечивающим доступ через Web к общей торговой системе предприятия. Возможности 
    доступа через портал ограничены функциями, необходимыми для реализаторов. 
    Используя портал, реализаторы могут связываться с торговым предприятием без 
    ограничений на место и время связи и работать с торговой системой, отчитываясь 
    за проданные товары и заказывая новые. Конфигурация для портала основана на 
    типовой конфигурации «Торговля+Склад» ред.8. Так как доступ реализаторов к 
    1С:Предприятию в ней изначально не предполагался, то конфигурация доработана 
    для использования с порталом.</p>
  <p style='text-align:justify;text-autospace:none'>Все документы, 
    создаваемый реализатором, записываются в торговую систему, но не проводятся 
    - их проведением управляет администратор портала или менеджер. До проведения 
    документы доступны для просмотра и модификации, после проведения - только 
    для просмотра.</p>
  <p style='text-align:justify;text-autospace:none'>Пользователь 
    может работать в портале в следующих режимах:</p>
  <ul type=disc>
    <li class=MsoNormal style='text-align:justify;     text-autospace:none'>информация.</li>
    <li class=MsoNormal style='text-align:justify;     text-autospace:none'>заказы.</li>
    <li class=MsoNormal style='text-align:justify;     text-autospace:none'>список 
      заказов.</li>
    <li class=MsoNormal style='text-align:justify;     text-autospace:none'>данные 
      о реализации.</li>
    <li class=MsoNormal style='text-align:justify;     text-autospace:none'>список 
      реализации</li>
    <li class=MsoNormal style='     text-autospace:none'>инвентаризация.</li>
    <ol start=1 type=1>
      <ul type=square>
        <li class=MsoNormal style='       text-autospace:none'>список инвентаризаций</li>
      </ul>
    </ol>
    <li class=MsoNormal style='     text-autospace:none'>отчет о расчетах по реализации.</li>
    <li class=MsoNormal style='     text-autospace:none'>отчет о реализации.</li>
    <li class=MsoNormal style='     text-autospace:none'>прайс-лист.</li>
  </ul>
  <p style='text-align:justify;text-autospace:none'>Для каждого 
    режима в системе присутствует краткое описание назначения режима и возможные 
    действия в этом режиме. Для вызова справки на каждой странице расположена 
    ссылка «подробнее об этом режиме».</p>
  <p style='text-align:justify;text-autospace:none'>Завершение 
    работы с порталом осуществляется выбором пункта меню «Завершение работы».</p>
  <h3><a name="_Toc497074181"></a><a name="_Toc497074739"></a><a
name="_Toc497075652">Конфигурация</a></h3>
  <p style='text-align:justify;text-autospace:none'>В качестве 
    конфигурации используется типовая конфигурация «Торговля+Склад» 7.70.808. 
    В конфигурацию добавлена обработка Сессия, содержащая модуль сессии, и табличный 
    документ Прайс, используемый при подготовке прайс-листа. Для работы с Web-сервером 
    добавлены два пользователя  WebSessionI  и WebSession2 с правом на Web-расширение.</p>
  <p style='text-align:justify;text-autospace:none'>Для редактирования 
    информации для реализаторов используется внешний  отчет  InfoSet.ert.  Вся  
    информация  организована следующим образом:</p>
  <p style='text-align:justify;
text-autospace:none'>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; на верхнем уровне 
    находятся категории сообщений. Названия категорий выводятся в заголовки «окон» 
    сообщений на информационной странице;</p>
  <p style='text-align:justify;
text-autospace:none'>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; каждая категория 
    содержит сообщения, выводимые в «окна» категорий.</p>
  <p style='text-align:justify;
text-autospace:none'>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; кажадя категория 
    может быть специально помечена. В этом случае «окно» категории выводится в 
    левом столбце информационной страницы. Непомеченные категории выводятся в 
    правом столбце страницы. Категории, не содержащие сообщений, на информационную 
    страницу не выводятся.</p>
  <p style='text-align:justify;text-autospace:none'>В остальном 
    конфигурация оставлена неизменной.</p>
  <h3><a name="_Toc497074182"></a><a name="_Toc497074740"></a><a
name="_Toc497075653">Контроль работы с порталом</a></h3>
  <p style='text-align:justify;text-autospace:none'>Для защиты 
    от неавторизованного входа в систему в начале каждой страницы находится код:</p>
  <p style='text-align:justify;text-autospace:none'>Если ПроверкаРегистрации(Response) 
    = 0 Тогда Перейти -Выход;</p>
  <p style='text-align:justify;text-autospace:none'>КонецЕсли 
    ;</p>
  <p style='text-align:justify;text-autospace:none'>Response.CacheControl 
    = &quot;no-cache&quot;;</p>
  <p style='text-align:justify;text-autospace:none'>Response.AddHeader(&quot;Pragma&quot;, 
    &quot;no-cache&quot;) ;</p>
  <p style='text-align:justify;text-autospace:none'>Функция модуля 
    сессии  ПроверкаРегистрации  проверяет авторизацию пользователя в портале. 
    Если пользователь не прошел через процедуру регистрации в системе, функция 
    перенаправляет запрос на вход портала Default.asp-После успешного входа в 
    портал все последующие действия записываются в журнал регистрации с указанием 
    имени пользователя, указанного при входе. Строки Response. CacheConrol    
    и    Response. AddHeader    запрещают кэширование страницы на компьютере пользователя 
    -  это необходимо для правильной работы портала при перемещениях по кнопкам 
    браузера Back и Next.</p>
  <h3><a name="_Toc497074183"></a><a name="_Toc497074741"></a><a
name="_Toc497075654">Режимы работы портала Информация</a></h3>
  <p style='text-align:justify;text-autospace:none'>Страница с 
    информацией появляется сразу после входа в систему и предназначена для получения 
    общей информации, касающейся реализатора: долги, лучшие товары, рекомендации 
    по ценам и рекламе и т.д. Вся информация, кроме данных по долгам, одинакова 
    для всех реализаторов и редактируется внешним отчетом InfbSet.ert.</p>
  <p style='text-align:justify;text-autospace:none'>Товары могут 
    быть как выбраны из каталога (для этого используется ссылка «Выбор товаров 
    из каталога»), так и добавлены к заказу по заранее известному коду. По каталогу 
    товаров можно передвигаться как произвольно - используя список групп, так 
    и последовательно -по приведенным ссылкам на группы товаров. Количество заказанного 
    товара можно изменять, при этом для автоматического изменения цены достаточно 
    перейти в другое поле ввода или элемент управления.</p>
  <p style='text-align:justify;text-autospace:none'>Если нужно 
    найти некоторые товары по подстроке из названия, то можно воспользоваться 
    поиском «Поиск товаров по строке». Строка поиска может содержать пробелы для 
    поиска товаров с наменованиями, содержащими в качестве подстрок все строки, 
    разделенные пробелами- Общая сумма документа автоматически изменяется при 
    изменении количества заказываемого товара. Щелкнув по ссылке «Заказанные товары», 
    в любой момент можно просмотреть список товаров в текущем заказе. При необходимости 
    можно начать подбор товаров заново, полностью очистив текущий заказ (для этого 
    небходимо нажать кнопку «Очистить»). При входе на страницу параметры нового 
    заказа заполняются автоматически, но при необходимости можно создать новый 
    заказ, нажав кнопку «Новый». При нажатии кнопки «Записать» вся информация 
    о текущем заказе будет записана в соответствующий документ торговой системы. 
    Удаление текущего заказа выпоняется кнопкой &quot;Удалить&quot;. Для просмотра 
    предыдущих документов нужно ввести начало и конец нужного периода и щелкнуть 
    по ссылке &quot;Показать заказы за период&quot;.</p>
  <p style='text-align:justify;text-autospace:none'>Следует принимать 
    во внимание, что вся информация о текущем заказе  до  нажатия  кнопки  «Записать»  
    не  занесена  в информационную базу.</p>
  <h3><a name="_Toc497074184"></a><a name="_Toc497074742"></a><a
name="_Toc497075655">Список заказов</a></h3>
  <p style='text-align:justify;text-autospace:none'>Эта страница 
    используется для выбора нужного заказа из списка имеющихся документов. Заказы 
    выводятся только за указанный период. Для выбора заказа щелкните по ссылке, 
    соответствующей нужному документу. Если заказ еще не проведен, то его можно 
    удалить, нажав кнопку «X».</p>
  <h3><a name="_Toc497074185"></a><a name="_Toc497074743"></a><a
name="_Toc497075656">Данные о реализации</a></h3>
  <p style='text-align:justify;text-autospace:none'>Эта страница 
    предназначена для ввода реализатором документов о реализации имеющегося у 
    него товара и просмотра ранее введенных документов. В списке товаров выводятся 
    только товары, реально имеющиеся у реализатора на момент реализации или соответствующие 
    просматриваемому документу. Вы можете как ввести данные по новой реализации 
    (нажав «Новый»), так и просмотреть и изменить документы о предыдущих реализациях. 
    Для внесения данных о реализации введите дату реализации и количество реализованных 
    товаров и нажмите кнопку «Записать». Для просмотра предыдущих документов нужно 
    ввести начало и конец нужного периода и щелкнуть по ссылке «Показать список 
    реализации за период». Для удаления документа о реализации нажмите кнопку 
    «Удалить».</p>
  <p style='text-align:justify;text-autospace:none'>Следует принимать 
    во внимание, что вся информация о текущем реализации до нажатия кнопки «Записать» 
    не занесена в информационную базу.</p>
  <h3><a name="_Toc497074186"></a><a name="_Toc497074744"></a><a
name="_Toc497075657">Список реализации</a></h3>
  <p style='text-align:justify;text-autospace:none'>Эта страница 
    используется для выбора нужной реализации из списка имеющихся документов. 
    Документы о реализации выводятся только за указанный период.</p>
  <h3><a name="_Toc497074187"></a><a name="_Toc497074745"></a><a
name="_Toc497075658">Инвентаризация</a></h3>
  <p style='text-align:justify;text-autospace:none'>Эта страница 
    предназначена для проведения реализатором инвентаризации имеющегося у него 
    товара. В списке товаров выводятся только товары, реально имеющиеся у реализатора 
    на момент инвентаризации. Вы можете как вести данные для новой инвентаризации, 
    так и просмотреть и изменить предыдущие инвентаризации.  Изменения в предыдущих 
    инвентаризациях возможны только в случае, если соответствующие документы еще 
    не проведены в торговой организации.</p>
  <p style='text-align:justify;text-autospace:none'>Для ввода 
    инвентаризации введите дату инвентаризации и остатки по товарам и нажмите 
    кнопку «Записать». Для просмотра предыдущих инвентаризаций введите начало 
    и конец нужного периода и нажмите ссылку «Показать список инвентаризаций». 
    Для изменения предыдущих инвентаризаций необходимо при просмотре списка инвентаризаций 
    выбрать нужный документ, внести в него изменения и нажать «Записать». Для 
    удаления документа об инвентаризации нажмите кнопку «Удалить».</p>
  <h3><a name="_Toc497074188"></a><a name="_Toc497074746"></a><a
name="_Toc497075659">Список инвентаризаций</a></h3>
  <p style='text-align:justify;text-autospace:none'>Эта страница 
    используется для выбора нужной инвентаризации из списка имеющихся документов. 
    Документы об инвентаризации выводятся только за указанный период.</p>
  <p style='text-align:justify;text-autospace:none'>Для выбора 
    инвентаризации введите начало и конец нужного периода и затем нажмите ссылку, 
    соответствующую нужному документу.</p>
  <h3><a name="_Toc497074189"></a><a name="_Toc497074747"></a><a
name="_Toc497075660">Отчет о расчетах по реализации</a></h3>
  <p style='text-align:justify;text-autospace:none'>Эта страница 
    предназначена для получения информации о расчетах между реализатором и торговым 
    предприятием. Для получения этой информации можно использовать три различных 
    варианта отчета:</p>
  <p style='text-align:justify;
text-autospace:none'>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; краткий. Показывает 
    изменение общей задолженности за указанный период.</p>
  <p style='text-align:justify;
text-autospace:none'>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; развернутый. 
    Кроме изменения задолженности приводит список документов, образующих задолженность.</p>
  <p style='text-align:justify;
text-autospace:none'>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; подробный. В 
    дополнение к развернутому отчету приводятся взаимопогашения документов.</p>
  <p style='text-align:justify;text-autospace:none'>Для получения 
    отчета введите начало и конец нужного периода и нажмите кнопку, соответствующую 
    выбранному типу отчета. Отчет можно вывести в отдельном окне браузера, установив 
    флаг показа &quot;Показать отчет в отдельном окне&quot;.</p>
  <h3><a name="_Toc497074190"></a><a name="_Toc497074748"></a><a
name="_Toc497075661">Отчеты о реализации</a></h3>
  <p style='text-align:justify;text-autospace:none'>Эта страница 
    предназначена для получения информации о реализации товаров, полученных реализатором 
    от торгового предприятия. Для получения этой информации можно использовать 
    три различных варианта отчета:</p>
  <p style='text-align:justify;
text-autospace:none'>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; краткий. Показывает 
    изменение остатков товаров за указанный период.</p>
  <p style='text-align:justify;
text-autospace:none'>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; развернутый. 
    Кроме изменения остатков выводит список документов, изменявших остатки товаров.</p>
  <p style='text-align:justify;
text-autospace:none'>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; подробный. В 
    дополнение к развернутому отчету приводятся документы по изменениям остатков 
    товаров в течение указанного периода.</p>
  <p style='text-align:justify;text-autospace:none'>Для получения 
    отчета введите начало и конец нужного периода и нажмите кнопку, соответствующую 
    выбранному типу отчета. Отчет можно вывести в отдельном окне браузера, установив 
    флаг показа &quot;Показать отчет в отдельном окне&quot;.</p>
  <h3><a name="_Toc497074191"></a><a name="_Toc497074749"></a><a
name="_Toc497075662">Прайс-лист</a></h3>
  <p style='text-align:justify;text-autospace:none'>Эту страницу 
    можно распечатать как готовый прайс-лист, так и использовать ее как предварительный 
    шаблон для подготовки к печати прайс-листа конкретного реализатора. Для использования 
    страницы как шаблона ее необходимо сохранить в файл и затем использовать полученный 
    файл в программе подготовки прайс-листа (например, Microsoft Word или Excel).</p>
  <h3><a name="_Toc497074192"></a><a name="_Toc497074750"></a><a
name="_Toc497075663">Страницы портала</a></h3>
  <p style='text-align:justify;text-autospace:none'>Далее перечислены 
    страницы проекта, составляющие портал. Для передачи данных между браузером 
    и Web-сервероми используется стандартный метод передачи параметров GET. Это 
    позволяет обращаться к значениям параметров из языка, используя стандартную 
    функцию Request.QueryString.</p>
  <h3><a name="_Toc497074193"></a><a name="_Toc497074751"></a><a
name="_Toc497075664">Общие страницы</a></h3>
  <p style='text-align:justify;text-autospace:none'><b>Common.js</b> 
    Содержит функции на JavaScript, исполняемые клиентским приложением.  Common.js  
    содержит единственную  функцию ShowHelp, используемую при показе контекстной 
    справки по режиму.</p>
  <h4><a name="_Toc497074752"></a><a name="_Toc497075665">Common.</a>css</h4>
  <p style='text-align:justify;text-autospace:none'>Содержит стили, 
    определяющие общий дизайн приложения и используемые при визуализации отчетов.</p>
  <h4><a name="_Toc497074753"></a><a name="_Toc497075666">Global.</a>asa</h4>
  <p style='text-align:justify;text-autospace:none'>Файл, содержащий 
    реализацию предопределенных функций приложения Session_OnStart и Session_OnStop.</p>
  <h4><a name="_Toc497074754"></a><a name="_Toc497075667">Main.asp (frameset)</a></h4>
  <p style='text-align:justify;text-autospace:none'>Страница, 
    формирующая общий вид приложения. В левой области располагается основное меню 
    приложения, в правой -информация, соответствующая текущему режиму работы.</p>
  <h4><a name="_Toc497074755"></a><a name="_Toc497075668">Menu.</a>htm</h4>
  <p style='text-align:justify;text-autospace:none'>Страница, 
    содержащая основное меню приложения.</p>
  <h4><a name="_Toc497074756"></a><a name="_Toc497075669">Default.</a>asp</h4>
  <p style='text-align:justify;text-autospace:none'>Начальная 
    страница приложения. На этой странице расположена идентификация пользователя. 
    На эту страницу переадресовываются все запросы клиентского приложения, если 
    пользователь еще не авторизован в портале.</p>
  <h4><a name="_Toc497074757"></a><a name="_Toc497075670">Exit.</a>asp</h4>
  <p style='text-align:justify;text-autospace:none'>Страница, 
    завершающая сессию пользователя с порталом.</p>
  <h3><a name="_Toc497074194"></a><a name="_Toc497074758"></a><a
name="_Toc497075671">Информация</a></h3>
  <h4><a name="_Toc497074759"></a><a name="_Toc497075672">Info.</a>asp</h4>
  <p style='text-align:justify;text-autospace:none'>Информационная 
    страница. Информация о задолженности реализатора формируется функцией Информация_Досье 
    из модуля сессии. Остальной текст страницы одинаков для всех реализаторов 
    и берется из файла Web_Info.val, формируемый внешним отчетом InfoSetert.</p>
  <h3><a name="_Toc497074195"></a><a name="_Toc497074760"></a><a
name="_Toc497075673">Заказ</a></h3>
  <h4><a name="_Toc497074761"></a><a name="_Toc497075674">Order.</a>asp</h4>
  <p style='text-align:justify;text-autospace:none'>Достаточно 
    сложная страница, предназначенная для просмотра предыдущих товарных заказов 
    и редактирования документов о заказах. Order.asp состоит из двух областей 
    (frames), верхняя область предназначена для управления и всегда содержит страницу 
    Ord_Head.asp, нижняя область при выполнении различных действий может содержать 
    одну из страниц Ord_Cat.asp, Ord_FG.asp, Ord_Item.asp, Ord_List.asp.</p>
  <p style='text-align:justify;text-autospace:none'>Страница обрабатывает 
    параметр Action со следующими значениями:</p>
  <p style='text-align:justify;text-autospace:none'>• New. Это 
    значение эквивалентно отсутствию параметра Action. По этому значению создается 
    новый документ</p>
  <p style='text-align:justify;text-autospace:none'>«Документ. 
    Расход наяРеализатора» с атрибутами</p>
  <p style='text-autospace:none'>Заказ.Клиент = Реализатор;</p>
  <p style='text-autospace:none'>Заказ.Валюта = Реализатор.ВалютаВзаиморасчетов;</p>
  <p style='text-autospace:none'>Заказ.ТипЦен = Перечисление. 
    ТипыРасхЦен. Мелкооптовые ;</p>
  <p style='text-autospace:none'>Заказ.ПризнакНакладной <i>= </i>Перечисление.ПризнРасхНакл.Продажа 
    ;</p>
  <p style='text-autospace:none'>Заказ.Дата_Курса = Заказ.ДатаДок;</p>
  <p style='text-autospace:none'>Заказ.Курс = Заказ.Валюта.Курс.Получить(Заказ.Дата_Курса) 
    ;</p>
  <p style='text-autospace:none'>Заказ.Склад = Константа.ОсноанойСклад;</p>
  <p style='text-align:justify;text-autospace:none'>• Edit. Это 
    значение предназначено для просмотра и редактирования   уже   существующего   
    документа. Дополнительно к параметру Action в запрос включается параметр Order 
    с значением, возвращенным функцией ЗначениеВСтрокуВнутр для нужного документа. 
    В нижнюю область формы заказа выводится страница Ord_Item.asp.</p>
  <p style='text-align:justify;text-autospace:none'>• Delete. 
    Это значение используется для удаления текущего заказа из системы. Удаление 
    реализовано функцией модуля сессии УдалитьДокумент, в которую передается заказ, 
    реализатор и переменная, в которую помещается сообщение об ошибке при удалении 
    документа (если такая произошла).</p>
  <h4><a name="_Toc497074762"></a><a name="_Toc497075675">Ord_</a>Cat.asp</h4>
  <p style='text-align:justify;text-autospace:none'>Страница для 
    перехода по ветвям каталога товаров и выбора необходимого товара. Эта страница 
    выводится по умолчанию в нижней части формы заказа при переходе в режим заказа. 
    В дальнейшем она может быть вызвана по ссылке «Выбор товаров из каталога». 
    Страница использует функцию Заказ_Изменения из модуля сессии.</p>
  <h4><a name="_Toc497074763"></a><a name="_Toc497075676">Ord_</a>FG.asp</h4>
  <p style='text-align:justify;text-autospace:none'>Страница для 
    вывода результатов поиска товаров. Эта страница обрабатывает параметр Action 
    со следующими значениями:</p>
  <p style='text-align:justify;text-autospace:none'>•  ClearOrder. 
    Это значение удаляет все строки заказа. Страница использует функцию Заказ_Изменения 
    из модуля</p>
  <h4><a name="_Toc497074764"></a><a name="_Toc497075677">Ord_</a>Item.asp</h4>
  <p style='text-align:justify;text-autospace:none'>Страница для 
    просмотра текущего заказа. Обрабатывает параметр Action со следующими значениями:</p>
  <p style='text-align:justify;text-autospace:none'>• Delline. 
    Это значение удаляет строки с номером, указанным в параметре LineNumber;</p>
  <p style='text-align:justify;text-autospace:none'>• ClearOrder. 
    Это значение удаляет всех строк заказа.</p>
  <p style='text-align:justify;text-autospace:none'>Страница использует 
    функцию Заказ_ Изменения из модуля сессии.</p>
  <h4><a name="_Toc497074765"></a><a name="_Toc497075678">Ord_</a>List.asp</h4>
  <p style='text-align:justify;text-autospace:none'>Страница для 
    просмотра заказов за конкретный период. Обрабатывает параметр Action со следующими 
    значениями:</p>
  <p style='text-align:justify;text-autospace:none'>• DelOrder. 
    Это значение предназначено для удаления заказа с реквизитами, указанными в 
    параметре Order.</p>
  <p style='text-align:justify;text-autospace:none'>Параметры 
    BegDate и EndDate используются для указания соответственно начальной и конечной 
    даты периода. Страница использует функцию УдалитьДокумент из модуля сессии.</p>
  <h3><a name="_Toc497074196"></a><a name="_Toc497074766"></a><a
name="_Toc497075679">Данные о реализации</a></h3>
  <h4><a name="_Toc497074767"></a><a name="_Toc497075680">Sale. </a>asp</h4>
  <p style='text-align:justify;text-autospace:none'>Страница,   
    предназначенная  для   просмотра  предыдущих реализации и редактирования документов 
    о реализованных товарах.</p>
  <p style='text-align:justify;text-autospace:none'>Страница обрабатывает 
    параметр Action со следующими значениями:</p>
  <p style='text-align:justify;text-autospace:none'>• Write.   
    Это   значение   используется   для   записи заполненного документа о реализации. 
    В параметре Date передается дата документа, в параметре Changes -изменения 
    в документе по сравнению с предыдущей записью.</p>
  <p style='text-align:justify;text-autospace:none'>•  Delete. 
    Это значение используется для удаления документа о реализации.</p>
  <p style='text-align:justify;text-autospace:none'>•  New. Это 
    значение предназначено для создания нового документа о реализации.</p>
  <p style='text-align:justify;text-autospace:none'>• Edit. Это 
    значение используется для отображения ранее записанного документа. Документ 
    записывается в значение       параметра       Sale       функцией ЗначениеВСтрокуВнутр.</p>
  <p style='text-align:justify;text-autospace:none'>В графах Товар 
    и Количество выводится название реализуемого товара и оставшееся (по документам) 
    количество, в колонке Продано можно ввести количество реализованного товара.</p>
  <p style='text-align:justify;text-autospace:none'>Страница     
    использует     функции     ЗаписатьДокумент, УдалитьДокумент,         ПолучитьПараметры_Номер         
    и ЗапросТоварНаРеализации из модуля сессии.</p>
  <h4><a name="_Toc497074768"></a><a name="_Toc497075681">SalJList.</a>asp</h4>
  <p style='text-align:justify;text-autospace:none'>Список предыдущих 
    реализации за указанный период. Из списка можно выбрать и отредактировать 
    каждую конкретную реализацию. Страница обрабатывает параметр Action со следующими 
    значениями:</p>
  <p style='text-align:justify;text-autospace:none'>•  DelSale. 
    Это значение предназначено для удаления документа, записанного в параметр 
    Sale функцией ЗначениеВСтрокуВнутр</p>
  <h3><a name="_Toc497074197"></a><a name="_Toc497074769"></a><a
name="_Toc497075682">Инвентаризация</a></h3>
  <h4><a name="_Toc497074770"></a><a name="_Toc497075683">Inventor, asp</a></h4>
  <p style='text-align:justify;text-autospace:none'>Страница для 
    инвентаризации реализуемых товаров.</p>
  <p style='text-align:justify;text-autospace:none'>Страница обрабатывает 
    параметр Action со следующими значениями:</p>
  <p style='text-align:justify;text-autospace:none'>• Write.   
    Это   значение   используется  для   записи заполненного документа о реализации. 
    В параметре Date передается дата документа, в параметре Changes -изменения 
    в документе по сравнению с предыдущей записью.</p>
  <p style='text-align:justify;text-autospace:none'>•  Delete.  
    Это значение используется для удаления документа о реализации.</p>
  <p style='text-align:justify;text-autospace:none'>• New. Это 
    значение предназначено для создания нового документа о реализации.</p>
  <p style='text-align:justify;text-autospace:none'>•  Edit. Это 
    значение используется для отображения ранее записанного документа.  Документ 
    записывается в значение       параметра       Sale       функцией ЗначениеВСтрокуВнутр.</p>
  <p style='text-align:justify;text-autospace:none'>В графах Товар 
    и Количество выводится название реализуемого товара и оставшееся (по документам) 
    количество, в колонке Осталось можно ввести точное количество товара.</p>
  <p style='text-align:justify;text-autospace:none'>Страница использует 
    функции ЗаписатьДокумент, УдалитьДокумент,         ПолучитьПараметры_Номер         
    и ЗапросТоварНаРеализации из модуля сессии.</p>
  <h4><a name="_Toc497074771"></a><a name="_Toc497075684">Inv_</a>List.asp</h4>
  <p style='text-align:justify;text-autospace:none'>Список предыдущих 
    инвентаризаций за указанный период. Из списка можно выбрать и отредактировать 
    каждую конкретную инвентаризацию.</p>
  <p style='text-align:justify;text-autospace:none'>Страница обрабатывает 
    параметр Action со следующими значениями:</p>
  <p style='text-align:justify;text-autospace:none'>•  Dellnventory. 
    Это значение предназначено для удаления документа, записанного в параметр 
    Inventory функцией ЗначениеВСтрокуВнутр.</p>
  <h3><a name="_Toc497074198"></a><a name="_Toc497074772"></a><a
name="_Toc497075685">Отчет о расчетах по реализации</a></h3>
  <h4><a name="_Toc497074773"></a><a name="_Toc497075686">CFA.</a>asp</h4>
  <p style='text-align:justify;text-autospace:none'>Страница для 
    получения отчетов о расчетах по реализации. CFA.asp состоит из двух областей 
    (frames). Верхняя область страницы содержит CFA_Set.asp, нижняя - CFA_Data.asp.</p>
  <h4><a name="_Toc497074774"></a><a name="_Toc497075687">CFAJSet.</a>asp</h4>
  <p style='text-align:justify;text-autospace:none'>Страница для 
    ввода параметров отчета. Для создания отчета используется функция MakeReport 
    с параметром Mode - типом создаваемого отчета. Все параметры отчета передаются 
    в страницу CFA_Data.asp.</p>
  <h4><a name="_Toc497074775"></a><a name="_Toc497075688">CFA_</a>Data.asp</h4>
  <p style='text-align:justify;text-autospace:none'>Страница для 
    отображения отчета о расчетах. Обрабатывает параметр Mode с значениями:</p>
  <p style='text-align:justify;text-autospace:none'>• 1. Краткий 
    отчет.</p>
  <p style='text-align:justify;text-autospace:none'>• 2. Развернутый 
    отчет.</p>
  <p style='
text-autospace:none'>• 3. Подробный отчет.</p>
  <p style='text-align:justify;text-autospace:none'>и параметры 
    BegDate и EndDate - соответственно начальная и конечная   даты   отчета.   
    Страница   использует   функции Взаиморасчеты_0тчет,                    Взаиморасчеты_Досье, 
    Взаиморасчеты_ТовКредит и Взаиморасчеты_Документ из модуля сессии.</p>
  <h3><a name="_Toc497074199"></a><a name="_Toc497074776"></a><a
name="_Toc497075689">Отчет о реализации</a></h3>
  <h4><a name="_Toc497074777"></a><a name="_Toc497075690">Report.</a>asp</h4>
  <p style='text-align:justify;text-autospace:none'>Страница для 
    формирования отчетов по реализациям. Report.asp состоит из двух областей (frames). 
    Верхняя область страницы содержит Rep_Set.asp, нижняя - Rep_Data.asp.</p>
  <h4><a name="_Toc497074778"></a><a name="_Toc497075691">Rep_</a>Set.asp</h4>
  <p style='text-align:justify;text-autospace:none'>Страница для 
    ввода параметров отчета. Для создания отчета используется функция MakeReport 
    с параметром Mode – типом создаваемого отчета. Все параметры отчета передаются 
    в страницу Rep_Data.asp.</p>
  <h4><a name="_Toc497074779"></a><a name="_Toc497075692">RepJData.</a>asp</h4>
  <p style='text-align:justify;text-autospace:none'>Страница для 
    отображения отчета по реализациям. Обрабатывает параметр Mode с значениями:</p>
  <p style='text-align:justify;text-autospace:none'>• 1. Краткий 
    отчет.</p>
  <p style='text-align:justify;text-autospace:none'>• 2. Развернутый 
    отчет.</p>
  <p style='text-align:justify;text-autospace:none'>• 3. Подробный 
    отчет.</p>
  <p style='text-align:justify;text-autospace:none'>и параметры 
    BegDate и EndDate - соответственно начальная и конечная даты отчета.</p>
  <h4><a name="_Toc497074780"></a><a name="_Toc497075693">Price.</a>asp</h4>
  <p style='text-align:justify;text-autospace:none'>Страница для 
    вывода прайс-листа. Прайс-лист формируется в mxl-таблицу и сохраняется в отдельный 
    файл, после чего страница просто переадресует клиентский запрос на этот файл.</p>
  <h3><a name="_Toc497074200"></a><a name="_Toc497074781"></a><a
name="_Toc497075694">Модуль сессии</a></h3>
  <p style='text-align:justify;text-autospace:none'>В качестве 
    модуля сессии используется модуль обработки Сессия. Ниже перечислены только 
    процедуры и функции, требующие некоторого комментария.</p>
  <p style='text-align:justify;text-autospace:none'><b><i>Функция 
    ПроверкаРегистрации</i></b><b><i></i></b></p>
  <p style='text-align:justify;text-autospace:none'><b>Параметры:</b> 
    <i>Respons<b>e</b></i></p>
  <p style='text-align:justify;text-autospace:none'>Используется 
    для проверки регистрации пользователя в портале. Функцией используется тот 
    факт, что переменная модуля сессии Реализатор после успешной идентификации 
    содержит элемент справочника «Справочник-Контрагенты». В противном случае 
    пользователь  еще   не  прошел   регистрацию,   и   функция перенаправляет 
    запрос на страницу Default.asp и возвращает 0:</p>
  <p style='
text-autospace:none'>Если ПустоеЗначение(Реализатор) =,1 Тогда</p>
  <p style='text-autospace:none'>Response.Redirect(&quot;Default.asp&quot;);</p>
  <p style='text-align:justify;text-autospace:none'>Возврат 0;</p>
  <p style='text-autospace:none'>КонецЕсли ;</p>
  <p style='text-align:justify;text-autospace:none'>В   случае   
    успешного   завершения   ПроверкаРегистрации возвращает 1.</p>
  <p style='text-align:justify;text-autospace:none'><b>Процедура 
    Заказ_Изменения</b><b></b></p>
  <p style='text-align:justify;text-autospace:none'><b>Параметры:</b> 
    <i>Request</i></p>
  <p style='text-align:justify;text-autospace:none'>Используется 
    для внесений изменений, сделанных пользователем, в торговую систему. В качестве 
    параметра в процедуру передается стандартный  объект  Request,  необходимый 
    для  получения параметров из переданного запроса. В запросе могут присутствовать 
    три различных параметра:</p>
  <p style='text-align:justify;text-autospace:none'>• I_Changes. 
    Содержит изменения в существующих строках документа. Изменения записаны в 
    одну строку через разделитель «!» парами (номер строки, количество).</p>
  <p style='text-align:justify;text-autospace:none'>• G_ Changes.   
    Содержит   изменения   в   количестве заказываемых товаров, вне зависимости 
    от наличия этих товаров в документе. Изменения записаны в одну строку через 
    разделитель «!» парами (товар, количество). Товар в строке закодирован функцией 
    ЗначениеВСтрокуВнутр.</p>
  <p style='text-align:justify;text-autospace:none'>• C_Changes. 
    Содержит код товара, количество которого необходимо увеличить на 1.</p>
  <h3><a name="_Toc497074201"></a><a name="_Toc497074782"></a><a
name="_Toc497075695">Используемые приемы программирования Фреймы</a></h3>
  <p style='text-align:justify;text-autospace:none'>Главное окно 
    Портала реализатора представляет собой так называемый frameset или страницу, 
    содержащую другие страницы (фреймы, frames). Фреймы являются независимыми 
    страницами, и поэтому  могут  независимо  меняться,   но  имеют  общую «родительскую» 
    страницу, к которой могут обращаться по ссылке window.parent. Главное окно 
    реализовано в странице Main.asp.</p>
  <h3><a name="_Toc497074202"></a><a name="_Toc497074783"></a><a
name="_Toc497075696">Вызовы функций с других страниц</a></h3>
  <p style='text-align:justify;text-autospace:none'>В JavaScript 
    все объекты динамические, и новые свойства и методы добавляются к ним простым 
    присваиванием значения свойству или ссылки на функцию методу. Этим можно (и 
    нужно) пользоваться при обмене данными между различными страницами. Вызов 
    функции, определенной в другом окне, можно видеть на странице Order.asp. Строки</p>
  <p style='text-align:justify;text-autospace:none'>document.ShowOrder 
    = ShowOrder ;</p>
  <p style='text-align:justify;text-autospace:none'>document.ShowCatalog 
    = ShowCatalog;</p>
  <p style='text-align:justify;text-autospace:none'>document.FindGoods 
    = FindGoods;</p>
  <p style='text-align:justify;text-autospace:none'>определяют 
    новые функции у объекта document, просто присваивая им адреса соответствующих 
    функций (имена функций совпадают исключительно для удобства). Затем эти функции 
    можно вызвать из любого окна, имеющего ссылку на Order.asp - например, Ord_Head.asp, 
    который может обращаться к Order.asp, используя window.parent.</p>
  <h3><a name="_Toc497074203"></a><a name="_Toc497074784"></a><a
name="_Toc497075697">Передача параметров между страницами</a></h3>
  <p style='text-align:justify;text-autospace:none'>Все параметры 
    между страницами передаются методом GET, то есть параметры и значения конвертируются 
    в строки, разделяются символом «=», полученные пары объединяются символом 
    «&amp;», и результирующая строка добавляется к адресу запрашиваемой страницы 
    (URL) после символа «?». Например:</p>
  <p style='text-align:justify;text-autospace:none'>Rep_Data.asp?Mode<sup>==</sup>3&amp;BegDate<sup>==</sup>01.10.QS&amp;EndDate-^S. 
    10.98 Такой подход удобен тем, что нужный адрес можно собрать программным 
    путем, а для получения значения параметра на сервере можно использовать стандартную 
    функцию QueryString.</p>
  <h3><a name="_Toc497074204"></a><a name="_Toc497074785"></a><a
name="_Toc497075698">Навигация по справочнику</a></h3>
  <p style='text-align:justify;text-autospace:none'>Навигация 
    по справочнику реализована в странице Ord_Cat.asp. При переходе между группами 
    справочника эта страница запрашивается снова, при этом в качестве параметра 
    передается значение, возвращаемое ЗначениеВСтрокуВнутр для нужной группы.</p>
  <h3><a name="_Toc497074205"></a><a name="_Toc497074786"></a><a
name="_Toc497075699">Выбор из справочника</a></h3>
  <p style='text-align:justify;text-autospace:none'>Выбор из справочника 
    используется при подготовке заказа. Для занесения товара в список выбранных 
    используется функция OnChangeAmount, сохраняющая все изменения в массивы на 
    компьютере пользователя. При запросе новой страницы все изменения передаются 
    на Web-сервер.</p>
  <h3><a name="_Toc497074206"></a><a name="_Toc497074787"></a><a
name="_Toc497075700">Выбор из списка документов</a></h3>
  <p style='text-align:justify;text-autospace:none'>Выбор из списка 
    документов реализован, например, на странице Inventor.asp. В отличие от выбора 
    из справочника страница для выбора документа замещает предыдущую страницу, 
    поэтому результат выбора передается между страницами (а не между фреймами). 
    Как обычно, для этого используется добавление информации в адрес страницы.</p>
  <h3><a name="_Toc497074207"></a><a name="_Toc497074788"></a><a
name="_Toc497075701">Использование табличных документов для генерации HTML-страниц</a></h3>
  <p style='text-align:justify;text-autospace:none'>Этот прием 
    использован при создании прайс-листа. В качестве табличного документа взят 
    документ «Прайс» обработки Сессия. После заполнения прайса данными табличный 
    документ сохраняется в файл HTML, а в скрипте вызывается перенаправление запроса 
    из страницы Price.asp на страницу Reports/Price.htm.</p>
  <h3><a name="_Toc497074208"></a><a name="_Toc497074789"></a><a
name="_Toc497075702">Управление созданием таблицы</a></h3>
  <p style='text-align:justify;text-autospace:none'>Управление 
    созданием таблицы используется на страницах, выводящих   отчеты -   например,   
    CFA_Data.asp.   Таблицу, содержащую все нужные типы строк, можно создать визуально, 
    а затем в готовый HTML-код вписать фрагменты скрипта для заполнения строк 
    данными и вывода их в результирующую страницу.</p>
  <h3><a name="_Toc497074209"></a><a name="_Toc497074790"></a><a
name="_Toc497075703">Приемы </a>JavaScript</h3>
  <p style='text-align:justify;text-autospace:none'>Загрузить 
    страницу не в текущий фрейм (frame) можно кодом window.parent.&lt;iramename&gt;.location.href=&quot;page.htm&quot;; 
    Для отмены стандартной реакции браузера на событие нужно возвратить false 
    из обработчика события, если используется Netscape Navigator,  или  установить  
    event.returnValue  =  false,  если используется Microsoft Explorer.</p>
  <p style='text-align:justify;text-autospace:none'>Изменить ссылку 
    на ходу можно следующим приемом:</p>
  <p style='text-align:justify;text-autospace:none'>&lt;а href=&quot;&quot; 
    onclick<sup>==</sup>&quot;onClick(this)&quot;&gt;Ccылкa&lt;/a&gt; &lt;script 
    language^javascript^</p>
  <p style='text-align:justify;text-autospace:none'>function onClick(obj)</p>
  <p style='text-align:justify;text-autospace:none'>obj .href= 
    &quot;Необходимая страница&quot;;</p>
  <p style='text-align:justify;text-autospace:none'>При использовании 
    скрипта в странице с тегом &lt;FRAMESET&gt; рекомендуется размещать скрипт 
    между тегами &lt;HEAD&gt; и &lt;/HEAD&gt;</p>
  <center>
    <hr>
    <a href="web00.htm"><img src="../../images/oglav.gif" width="113" height="19" border="0" alt="Перейти  к оглавлению: " Web-расширение""></a> 
    <hr>
    <font size="1"><center>
<script>
// <!--
var userid = 34103;
var rndnum = Math.round(Math.random() * 10000);
document.write("<center><A href='http://bb.centre.ru/url.cgi?id=" + userid + "&rnd=" + rndnum + "' target='_top'>");
document.write("<IMG src='http://bb.centre.ru/show.cgi?id=" + userid + "&rnd=" + rndnum + "' width=468 height=60 Alt='Реклама на WEBSERVIS.RU' border=0></A></center>");
// -->
</script>

</center></font> 
  </center>
  <p align="center"><!-- SpyLOG v2 f:0111 --> 
    <script language="javascript"> 
u="u075.93.spylog.com";d=document;nv=navigator;na=nv.appName;p=1; 
bv=Math.round(parseFloat(nv.appVersion)*100); 
n=(na.substring(0,2)=="Mi")?0:1;rn=Math.random(); z="p="+p+"&rn="+rn;y=""; 
y+="<a href='http://"+u+"/cnt?f=3&p="+p+"&rn="+rn+"' target=_blank>"; 
y+="<img src='http://"+u+"/cnt?"+z+ 
"&r="+escape(d.referrer)+ "&pg="+escape(window.location.href)+"' border=0 width=88 height=31 alt='SpyLOG'>"; 
y+="</a>"; d.write(y); if(!n) { d.write("<"+"!--"); } //--></script>
    <noscript> <a href="http://u075.93.spylog.com/cnt?f=3&p=1" target=_blank> 
    <img src="file:///c:/temp/u075.93.spylog.com/cnt@p=1" alt='SpyLOG' border='0' width=88 height=31 > 
    </a> </noscript> 
    <script language="javascript1.2"><!-- 
if(!n) { d.write("--"+">"); }//--></script>
    <!-- SpyLOG --> </p>
  <p style='text-align:justify;text-autospace:none'>&nbsp;</p>
</body>
</html>


<html>
<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1251">
<title>1С-Предприятие. Документация | Описание внешней компоненты V7Plus.dll. 
Введение. Свойства и методы объекта V7Mail</title>
<link rel="stylesheet" type="text/css" href="../../../1c.css">
<style><!--
h5 {  border-width: 0px 0px thin; text-decoration: underline; font-style: italic}
h1 {  text-align: center}
h2 {  text-align: center}
h3 {  text-align: center}
h4 {  text-align: center}
-->
</style>
</head>
<body link=#0000FF vlink=#800080 background="../../../images/background_main.gif">
<h2 class="highlink"><a name=""><font size="4">Введение.</font></a></h2>
<h2 class="highlink"><a name=""><font size="4">Свойства и методы объекта V7Mail</font></a></h2>
<hr>
<p><b><a href="#_toc502239066">Введение</a></b></p>
<p><b><a href="#_toc502239067">Свойства и методы объекта V7Mail</a></b></p>
<ul>
  <li><a href="#_toc502239068">Назначение и порядок использования</a></li>
  <li><a href="#_toc502239069">Настройка параметров объекта</a></li>
  <li><a href="#_toc502239070">Тип почты</a> 
    <ul>
      <li><a href="#_toc502239071">MAPI</a></li>
      <li><a href="#_toc502239072">1C:Электронная почта</a></li>
    </ul>
  </li>
  <li><a href="#_toc502239073">Описание атрибутов и методов объекта V7Mail</a> 
    <ul>
      <li><a href="#_toc502239074">Атрибуты</a> 
        <ul>
          <li><a href="#_toc502239075">Заголовок</a></li>
          <li><a href="#_toc502239076">Текст</a></li>
          <li><a href="#_toc502239077">ДатаОтправки</a></li>
        </ul>
      </li>
      <li><a href="#_toc502239078">Методы</a> 
        <ul>
          <li><a href="#_toc502239079">Подключиться</a></li>
          <li><a href="#_toc502239080">Отключиться</a></li>
          <li><a href="#_toc502239081">НовоеСообщение</a></li>
          <li><a href="#_toc502239082">ДобавитьАдрес</a></li>
          <li><a href="#_toc502239083">ДобавитьФайл</a></li>
          <li><a href="#_toc502239084">Послать</a></li>
          <li><a href="#_toc502239085">ВыбратьСообщения</a></li>
          <li><a href="#_toc502239086">ПолучитьСообщение</a></li>
          <li><a href="#_toc502239087">ПрочитатьСообщение</a></li>
          <li><a href="#_toc502239088">АдресОтправителя</a></li>
          <li><a href="#_toc502239089">ПолучитьФайл</a></li>
          <li><a href="#_toc502239090">УдалитьСообщение</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#_toc502239091">Примеры</a></li>
  <li><a href="#_toc502239092">Особенности работы с различными клиентами MAPI.</a> 
    <ul>
      <li><a href="#_toc502239093">Outlook Express 5.0.</a></li>
      <li><a href="#_toc502239094">Outlook 97.</a></li>
      <li><a href="#_toc502239095">Outlook 2000.</a></li>
      <li><a href="#_toc502239096">Netscape Messenger.</a></li>
    </ul>
  </li>
</ul>
  <h2><a name="_Toc502239066">Введение</a></h2>
  
<p>Внешняя компонента V7Plus.dll (релиз 001-003) состоит из четырех объектов V7Mail, 
  V7SysInfo, V7HttpReader и XMLParser. В релиз 004 компоненты добавлен объект 
  для работы с текстовыми файлами - V7TextFile.</p>
  
<p>Инициализация внешней компоненты может осуществляется с помощью метода <span class="src">ЗагрузитьВнешнююКомпоненту(&lt;ИмяФайлаКомпоненты&gt;)&quot;</span> 
  где </p>
  
<p><span class="src">&lt;ИмяФайлаКомпоненты&gt;</span> - имя файла внешней компоненты 
  &quot;V7Plus.dll&quot;. </p>
  <p>Если не указан пусть поиска, файл компоненты ищется последовательно в каталоге 
    пользователя, в каталоге информационной базы, и в каталоге c исполняемым файлом 
    1С:Предприятия.</p>
  <h2><a name="_Toc502239067">Свойства и методы объекта V7Mail</a></h2>
  <h3><a name="_Toc502239068">Назначение и порядок использования</a></h3>
  <p>Объект компоненты предназначен для расширения функциональности 1С:Предприятия 
    в части работы с электронной почтой. Он позволяет работать как с программой 
    &quot;1C:Электронная Почта&quot;, так и с любым почтовым клиентом, работающим 
    через MAPI (например Outlook Express, Outlook ). С помощью объекта V7Mail 
    можно создавать, посылать и принимать сообщения, причем сообщение может иметь 
    несколько адресатов и присоединенных файлов. </p>
  <p>Для осуществления доступа к методам и свойствам объекта V7Mail необходимо 
    вызвать функциюСоздатьОбъект, передав ей строку &quot;AddIn.V7Mail&quot; в 
    качестве параметра, и получить ссылку на объект, которая присваивается переменной, 
    через которую и будет осуществляться доступ.</p>
  <p>Например:</p>
  
<p class="src">Почта = СоздатьОбъект(&quot;AddIn.V7Mail&quot;);</p>
  <p>Работа с почтой начинается с установки соединения с помощью метода Подключиться, 
    который инициализирует сеанс работы с почтой. Если параметры подключения не 
    заданы, то они берутся со страницы свойств компоненты. Для организации сеанса 
    с параметрами подключения, отличающимися от заданных на странице свойств компоненты, 
    необходимо указать эти параметры в методе Подключиться. Если подключение прошло 
    успешно, можно начать работу с сообщениями.</p>
  <p>Для инициализации процесса создания нового сообщения используется метод НовоеСообщение. 
    Далее, с помощью метода ДобавитьАдрес можно задать один или несколько адресов, 
    по которым будет отправлено сообщение. Формат адреса зависит от почтового 
    клиента, выбранного в параметрах подключения. При необходимости, можно присоединить 
    к сообщению один или несколько файлов, воспользовавшись методом ДобавитьФайл. 
    Заголовок и текст сообщения задаются в соответствующих атрибутах сообщения.</p>
  <p>Отправка сообщения осуществляется с помощью метода Послать. Для успешной 
    отправки сообщения необходимо, чтобы для него был задан хотя бы один адресат. 
    Метод Послать предоставляет возможность просмотра и редактирования сообщения 
    перед отправкой (только в случае работы с клиентом MAPI ). Для этого необходимо 
    передать в качестве параметра &lt;Просмотр&gt; 1.</p>
  <p>Процесс приема сообщений инициализируется методом ВыбратьСообщения. Если 
    в полученной выборке присутствует хотя бы одно сообщение - он возвращает 1, 
    в противном случае - 0. Если выбрано хотя бы одно сообщение, то можно организовать 
    цикл их получения с помощью метода ПолучитьСообщение, который последовательно 
    выбирает их из полученной выборки. Если возвращаемое значение равно 0, то 
    сообщений больше нет. После получения сообщения доступны для чтения адрес 
    отправителя и заголовок сообщения. Для получения доступа к тексту и присоединенным 
    файлам сообщения, его необходимо прочитать с помощью метода ПрочитатьСообщение. 
    Этот метод изменяет статус сообщения на прочитанное, и оно не попадает в последующие 
    выборки. </p>
  <p>Если необходимо, чтобы сообщение попадало в последующие выборки, можно не 
    изменять статус сообщения, передав в качестве параметра 0. Текст сообщения 
    хранится в атрибуте Текст, а полные пути к присоединенным файлам можно получить, 
    организовав цикл с помощью метода ПолучитьФайл. Если присоединенных файлов 
    больше нет, метод ПолучитьФайл возвращает 0. Файлы копируются во временный 
    каталог и удаляются при переходе на следующее сообщение (ПолучитьСообщение).</p>
  <p>Завершается работа с почтой с помощью метода Отключиться.</p>
  <h3><a name="_Toc502239069">Настройка параметров объекта</a></h3>
  <p>Настройка параметров объекта V7Mail производится в диалоге системных настроек, 
    который вызывается при выборе пункта &quot;Параметры&quot; раздела меню &quot;Сервис&quot;. 
  </p>
  <p>На закладке &quot;Электронная почта&quot; вынесены следующие настройки:</p>
  <h4><a name="_Toc502239070">Тип почты</a></h4>
  <p> &quot;MAPI&quot; или &quot;1C:Электронная Почта&quot; - позволяет установить 
    тип электронной почты, с которой будет работать компонента. Если этот параметр 
    не задан, при инициализации сеанса работы с почтой в методе Подключиться следует 
    указать его значение (см. описание метода Подключиться).</p>
  <p>В зависимости от выбранного типа электронной почты на странице свойств отображаются 
    соответствующие данному типу параметры подключения.</p>
  <h4><a name="_Toc502239071">MAPI</a></h4>
  <p><b> </b>Для этого типа электронной почты необходимо указать следующие параметры: 
  </p>
  <p>Конфигурация подключения (строковое выражение) - конфигурация подключения 
    (например - &quot;Outlook&quot;).</p>
  <p>Пароль (строковое выражение) - пароль абонента.</p>
  <p>Указывать параметры не обязательно, т.к. если они не заданы или заданы неправильно, 
    то при инициализации сеанса работы с почтой методом Подключиться без параметров 
    выбирается конфигурация подключения, заданная по умолчанию почтовым клиентом 
    &quot;MAPI&quot;.</p>
  <p>Если нужно организовать сеанс работы с почтой с параметрами подключения, 
    отличными от заданных в конфигурации подключения клиента MAPI, то нужно задать 
    эти параметры на странице свойств компоненты (&quot;Сервис/Параметры/Электронная 
    почта&quot;) или в методе Подключиться.</p>
  <h4><a name="_Toc502239072">1C:Электронная почта</a></h4>
  <p>Для этого типа электронной почты необходимо указать следующие параметры: 
  </p>
  <p>Имя пользователя (строковое выражение) - почтовое имя абонента в системе 
    &quot;1С:Электронная Почта&quot; (например - &quot;ИМЯ.УЗЕЛ&quot;, где Имя 
    - локальное имя пользователя, УЗЕЛ - наименование почтового узла).</p>
  <p>Пароль (строковое выражение) - пароль абонента в системе &quot;1С:Электронная 
    Почта&quot;.</p>
  <p>Каталог почтового узла (строковое выражение) - путь к сетевому почтовому 
    узлу (диск должен быть обязательно подключен).</p>
  <p>В случае использования программы &quot;1С:Электронная Почта&quot; параметры 
    подключения должны быть обязательно определены либо на странице свойств компоненты, 
    либо при инициализации сеанса работы с почтой с помощью метода Подключиться. 
    Все параметры являются обязательными и не могут быть пропущены. При нажатии 
    кнопки Применить компонента пытается установить соединение с почтовым узлом 
    и, если соединение установлено, сохраняет параметры подключения. </p>
  <p>В случае использования программы &quot;1С:Электронная Почта&quot; необходимо 
    дополнительно использовать dll-файлы &quot;1cml32.dll&quot; и &quot;unizip32.dll&quot;, 
    которые следует поместить в каталог с файлом программы (на<b>Пример:</b> &quot;C:\Program 
    Files\1cv77\BIN&quot;) или каталог базы данных.</p>
  <p>Внимание!!! Если до использования метода Подключить уже запущена программа 
    &quot;1C:Электронная Почта&quot;, соединение с почтовым узлом не может быть 
    установлено, а в табло сообщений об этом выводится соответствующее сообщение.</p>
  <h3><a name="_Toc502239073">Описание атрибутов и методов объекта V7Mail</a></h3>
  <h4><a name="_Toc502239074">Атрибуты</a></h4>
  
<h5><a name="_Toc502239075">Заголовок</a></h5>
  <p><b>Синтаксис:</b></p>
  <p><b> </b>Заголовок</p>
  <p><b>Англоязычный синоним:</b></p>
  <p><b> </b>Subject</p>
  <p><b>Описание:</b></p>
  <p>Заголовок сообщения (строковое выражение). </p>
  <h5> <a name="_Toc502239076">Текст</a></h5>
  <p><b>Синтаксис:</b></p>
  <p><b> </b>Текст</p>
  <p><b>Англоязычный синоним:</b></p>
  <p><b> </b>Text</p>
  <p>&nbsp;</p>
  <p><b>Описание:</b></p>
  <p>Текст сообщения (строковое выражение). </p>
  
<h5>&nbsp;</h5>
<h5><a name="_Toc502239077">ДатаОтправки</a></h5>
  <p><b>Синтаксис:</b></p>
  <p>ДатаОтправки</p>
  <p><b>Англоязычный синоним:</b></p>
  <p><b> </b>DatеSend</p>
  <p><b>Описание:</b></p>
  <p>Дата отправки письма в формате &quot;ГГГГ/ММ/ДД ЧЧ:ММ&quot;, где ГГГГ - год, 
    ММ - месяц, ДД - день; ЧЧ - час, ММ - минута отправки письма.</p>
  
<h4>&nbsp;</h4>
<h4><a name="_Toc502239078">Методы</a></h4>
<h5>&nbsp;</h5>
<h5><a name="_Toc502239079">Подключиться</a></h5>
  <p><b> </b>Инициализация сеанса работы с почтой</p>
  <p><b>Синтаксис:</b></p>
  <p>Подключиться()</p>
  <p>Подключиться(&quot;1C&quot;, &lt;ИмяАбонента&gt;, &lt;Пароль&gt;, &lt;КаталогПочтовогоУзла&gt;)</p>
  <p>Подключиться(&quot;MAPI&quot;, &lt;КонфигурацияПодключения&gt;, &lt;Пароль&gt;)</p>
  <p><b>Англоязычный синоним:</b></p>
  <p><b> </b>Logon</p>
  <p><b>Параметры:</b></p>
  <p><b> </b><span class="src">&lt;ИмяАбонента&gt;</span> (строковое выражение) 
    - почтовое имя абонента в системе &quot;1С:Электронная Почта&quot;</p>
  <p><b> </b>&lt;Пароль&gt; (строковое выражение) - пароль</p>
  <p><b> </b>&lt;КаталогПочтовогоУзла&gt; (строковое выражение) - каталог почтового 
    узла (диск должен быть обязательно подключен)</p>
  <p>            &lt;КонфигурацияПодключения&gt; (строковое выражение) - название 
    используемой конфигурации подключения</p>
  <p><b>Возвращаемое значение:</b></p>
  <p><b> </b>Нет</p>
  <p><b>Описание:</b></p>
  <p>1.Метод Подключиться инициализирует сеанс работы с почтой в соответствии 
    с выбранным на закладке свойств компоненты типом почты и параметрами подключения.</p>
  <p>2.Метод Подключиться инициализирует сеанс работы с &quot;1С:Электронная Почта&quot; 
    с выбранными параметрами подключения. </p>
  <p>3.Метод Подключиться инициализирует сеанс работы с почтой MAPI с соответствующими 
    параметрами подключения и паролем.</p>
  
<h5>&nbsp;</h5>
<h5><a name="_Toc502239080">Отключиться</a></h5>
  <p> Завершить сеанса работы с почтой</p>
  <p><b>Синтаксис:</b></p>
  <p>Отключиться()</p>
  <p><b>Англоязычный синоним:</b></p>
  <p>Logoff</p>
  <p><b>Параметры:</b></p>
  <p><b> </b>Нет</p>
  <p><b>Возвращаемое значение:</b></p>
  <p>Нет</p>
  <p><b>Описание:</b></p>
  <p>Метод Отключиться завершает сеанс работы с почтой инициализированный методом 
    Подключиться.</p>
  
<h5>&nbsp;</h5>
<h5><a name="_Toc502239081">НовоеСообщение</a></h5>
  <p><b> </b>Создать новое сообщение</p>
  <p><b>Синтаксис:</b></p>
  <p>НовоеСообщение()</p>
  <p><b>Англоязычный синоним:</b></p>
  <p>NewMessage</p>
  <p><b>Параметры:</b></p>
  <p><b> </b>Нет</p>
  <p><b>Возвращаемое значение:</b></p>
  <p><b> </b>Нет</p>
  <p><b>Описание:</b></p>
  <p>Метод НовоеСообщение инициализирует создание нового сообщения. После инициализации 
    происходит заполнение его реквизитов с последующим вызовом метода Послать.</p>
  
<h5>&nbsp;</h5>
<h5><a name="_Toc502239082">ДобавитьАдрес</a></h5>
  <p>Добавляет адрес рассылки письма</p>
  <p><b>Синтаксис:</b></p>
  <p>ДобавитьАдрес(&lt;Адрес&gt;)</p>
  <p><b>Англоязычный синоним:</b></p>
  <p>AddAddress</p>
  <p><b>Параметры:</b></p>
  <p>&lt;Адрес&gt; (строковое выражение) - почтовый адрес</p>
  <p><b>Возвращаемое значение:</b></p>
  <p>Нет</p>
  <p><b>Описание:</b></p>
  <p>Метод ДобавитьАдрес добавляет адрес в список адресов получателей данного 
    сообщения, созданного методом НовоеСообщение. Адрес формируется в соответствии 
    с выбранным типом ЭП.</p>
  
<h5>&nbsp;</h5>
<h5><a name="_Toc502239083">ДобавитьФайл</a></h5>
  <p><b> </b>Добавляет файл к письму</p>
  <p><b>Синтаксис:</b></p>
  <p>ДобавитьФайл(&lt;ИмяФайла&gt;)</p>
  <p><b>Англоязычный синоним:</b></p>
  <p>AddFile</p>
  <p><b>Параметры:</b></p>
  <p>&lt;ИмяФайла&gt; (строковое выражение) - значение полного пути к добавляемому 
    файлу</p>
  <p><b>Возвращаемое значение:</b></p>
  <p><b><span> </span></b>Нет</p>
  <p><b>Описание:</b></p>
  <p>Метод ДобавитьФайл позволяет добавить имя нового файла в  список присоединенных 
    файлов сообщения, созданного методом   НовоеСообщение.  Файл должен существовать. 
    В случае &quot;1C:Электронная Почта&quot;  диск, на котором находится файл 
    (диск должен быть обязательно подключен).</p>
  
<h5>&nbsp;</h5>
<h5><a name="_Toc502239084">Послать</a> </h5>
  <p><b> </b>Послать сообщение</p>
  <p><b>Синтаксис:</b></p>
  <p>Послать(&lt;Просмотр&gt;)</p>
  <p><b>Англоязычный синоним:</b></p>
  <p>Send</p>
  <p><b>Параметры:</b></p>
  <p>&lt;Просмотр&gt; числовое значение</p>
  <p>0 - не отображать окно редактирования сообщения перед отправкой (значение 
    по умолчанию)</p>
  <p>1 - отображает окно редактирования и позволяет просмотреть и отредактировать 
    сообщение перед отправкой (только в случае работы с клиентом MAPI)</p>
  <p><b>Возвращаемое значение:</b></p>
  <p><b><span> </span></b>Нет</p>
  <p><b>Описание:</b></p>
  <p>Метод Послать позволяет отправить сообщение, созданного  методом НовоеСообщение. 
    У посылаемого сообщения  обязательно должен быть задан хотя бы один адресат.</p>
  
<h5>&nbsp;</h5>
<h5><a name="_Toc502239085">ВыбратьСообщения</a> </h5>
  <p><b> </b>Инициализирует процесс получения сообщений </p>
  <p><b>Синтаксис:</b></p>
  <p>ВыбратьСообщения()</p>
  <p><b>Англоязычный синоним:</b></p>
  <p>SelectMеssages</p>
  <p><b>Параметры:</b></p>
  <p>Нет</p>
  <p><b>Возвращаемое значение:</b></p>
  <p>Числовое значение: </p>
  <p>0 - сообщений нет;</p>
  <p>1 - выбрано хотя бы одно сообщение.</p>
  <p><b>Описание:</b></p>
  <p>Метод ВыбратьСообщения инициализирует процесс получения сообщений с помощью 
    метода ПолучитьСообщение.</p>
  <p>&nbsp;</p>
<h5>&nbsp;</h5>
<h5><a name="_Toc502239086">ПолучитьСообщение</a> </h5>
  <p> ПолучитьСообщение</p>
  <p><b>Синтаксис:</b></p>
  <p>ПолучитьСообщение()</p>
  <p><b>Англоязычный синоним:</b></p>
  <p>ReceiveMessage</p>
  <p><b>Параметры:</b></p>
  <p><b> </b>Нет</p>
  <p><b>Возвращаемое значение:</b></p>
  <p>Числовое значение: </p>
  <p>1 - сообщение получено успешно;</p>
  <p>0 - сообщений больше нет.</p>
  <p><b>Описание:</b></p>
  <p>Метод ПолучитьСообщение выбирает следующее сообщение из  выборки, открытой 
    с помощью метода ВыбратьСообщения.  Данный метод используется для организации 
    цикла по  сообщениям. После получения сообщения доступны для чтения  адрес 
    отправителя и заголовок сообщения. Содержимое  сообщения (текст и присоединенные 
    файлы) будет доступно  после выполнения метода ПрочитатьСообщение.</p>
  
<h5>&nbsp;</h5>
<h5><a name="_Toc502239087">ПрочитатьСообщение</a> </h5>
  <p><b> </b>Получить содержимое сообщения</p>
  <p><b>Синтаксис:</b></p>
  <p>ПрочитатьСообщение(&lt;Флаг&gt;)</p>
  <p><b>Англоязычный синоним:</b></p>
  <p>ReadMessage</p>
  <p><b>Параметры:</b></p>
  <p><b><span> </span></b>&lt;Флаг&gt; Числовое значение</p>
  <p>0 - не помечать как прочитанное</p>
  <p>1 - помечать как прочитанное  (значение по умолчанию)</p>
  <p><b>Возвращаемое значение:</b></p>
  <p><b><span> </span></b>Нет</p>
  <p><b>Описание:</b></p>
  <p><b> </b>Метод ПрочитатьСообщение позволяет получить содержимое  сообщения 
    (текст и присоединенные файлы), полученного с помощью метода ПолучитьСообщение. 
    Текст сообщения хранится в атрибуте Текст, а полные пути к присоединенным 
    файлам можно получить с помощью  метода ПолучитьФайл. Файлы копируются во 
    временную директорию и удаляются при переходе на следующее сообщение (метод 
    ПолучитьСообщение) </p>
  <p><b> </b>Параметр &lt;Флаг&gt; определяет состояние сообщения после  прочтения: 
  </p>
  <p>0 - сообщение не помечается как прочитанное и может быть повторно получено 
    и прочитано;</p>
  <p>1 - сообщение помечается как прочитанное и не попадает в последующие выборки.</p>
  <p>&nbsp;</p>
  
<h5>&nbsp;</h5>
<h5><a name="_Toc502239088">АдресОтправителя</a> </h5>
  <p><b> </b>Получить адрес отправителя полученного сообщения</p>
  <p><b>Синтаксис:</b></p>
  <p>АдресОтправителя()</p>
  <p><b>Англоязычный синоним:</b></p>
  <p>SenderAddress</p>
  <p><b>Параметры:</b></p>
  <p><b> </b>Нет</p>
  <p><b>Возвращаемое значение:</b></p>
  <p>&lt;Адрес&gt; (строковое выражение) - значение адреса отправителя сообщения</p>
  <p><b>Описание:</b></p>
  <p>Метод АдресОтправителя позволяет получить адрес, с которого было отправлено 
    сообщение. Для того, чтобы получить адреса отправителя надо сначала получить 
    сообщение с помощью метода ПолучитьСообщение.</p>
  
<p>&nbsp;</p><h5><a name="_Toc502239089">ПолучитьФайл</a> </h5>
  <p>Получить имя и полный путь к следующему присоединенному файлу полученного 
    сообщения</p>
  <p><b>Синтаксис:</b></p>
  <p>ПолучитьФайл(&lt;ИмяФайла&gt;,&lt;Каталог&gt;)</p>
  <p><b>Англоязычный синоним:</b></p>
  <p>GetFile</p>
  <p><b>Параметры (возвращаемые):</b></p>
  <p>&lt;ИмяФайла&gt; (строковое выражение) - имя файла</p>
  <p><b><span> </span></b>&lt;Каталог&gt; (строковое выражение) - каталог  <b> </b>(Disk:\Path\)</p>
  <p><b>Возвращаемое значение:</b></p>
  <p>Числовое значение: </p>
  <p>1 - получено успешно;</p>
  <p>0 - файлов больше нет</p>
  <p><b>Описание:</b></p>
  <p>Метод ПолучитьФайл получить имя и каталог следующего  присоединенного файла 
    сообщения, прочитанного с помощью  метода  ПрочитатьСообщение. Данный метод 
    используется для  организации цикла по присоединенным файлам сообщения. Если  
    файл в дальнейшем планируется использовать, то его  необходимо переименовать 
    или скопировать в другое место.  При получении следующего сообщения все присоединенные 
    файлы данного сообщения будут удалены.</p>
  <p>&nbsp;</p>
<h5><a name="_Toc502239090">УдалитьСообщение</a> </h5>
  <p><b> </b>Удалить сообщение</p>
  <p><b>Синтаксис:</b></p>
  <p>УдалитьСообщение()</p>
  <p><b>Англоязычный синоним:</b></p>
  <p>DeleteMessage</p>
  <p><b>Параметры:</b></p>
  <p><b><span> </span></b>Нет</p>
  <p><b>Возвращаемое значение:</b></p>
  <p><b><span> </span></b>Нет</p>
  <p><b>Описание:</b></p>
  <p>Метод УдалитьСообщение удаляет текущее сообщение,  полученное с помощью метода 
    ПолучитьСообщение. (и,  возможно, прочитанное с помощью метода ПрочитатьСообщение). 
  </p>
  <h3> <a name="_Toc502239091">Примеры</a></h3>
  <p><span class="src">Перем Почта Экспорт;</span></p>
  <p><span class="src">ЗагрузитьВнешнююКомпоненту(&quot;V7Plus.dll&quot;);</span></p>
  <p><span class="src">Почта = СоздатьОбъект(&quot;AddIn.V7Mail&quot;);</span></p>
  <p><span class="src">Процедура ПослатьСообщение()</span></p>
  <p><span class="src">Почта.Подключиться(&quot;MAPI&quot;,&quot;МояКонфигурацияПодключения, 
    &quot;&quot;);</span></p>
  <p><span class="src">Почта.НовоеСообщение();</span></p>
  <p><span class="src">Почта.ДобавитьАдрес(&quot;<a href="mailto:xxx@yyy.zzz">xxx@yyy.zzz</a>&quot;);</span></p>
  <p><span class="src">Почта.ДобавитьФайл(&quot;invoice.txt&quot;);</span></p>
  <p><span class="src">Почта.Заголовок=&quot;Прайс-лист фирмы ТоргТехника&quot;;</span></p>
  <p><span class="src">Почта.Текст=&quot;В прилагаемом файле помещен прайс лист 
    нашей </span></p>
  <p><span class="src">фирмы&quot;;</span></p>
  <p><span class="src">Почта.Послать();</span></p>
  <p><span class="src">Почта.Отключиться();</span></p>
  <p><span class="src"><b> </b>КонецПроцедуры</span></p>
  <p><span class="src">Процедура ПринятьСообщения()</span></p>
  <p><span class="src">Перем ПутьКФайлу, ИмяФайла;</span></p>
  <p><span class="src">ТекстДок=СоздатьОбъект(&quot;Текст&quot;);</span></p>
  <p><span class="src">Почта.Подключиться();</span></p>
  <p><span class="src">Почта.ВыбратьСообщения();</span></p>
  <p><span class="src">Пока Почта.ПолучитьСообщение() = 1 Цикл </span></p>
  <p><span class="src">АдресОтправителя=Почта.АдресОтправителя();</span></p>
  <p><span class="src">Заголовок=Почта.Заголовок; </span></p>
  <p><span class="src">Почта.ПрочитатьСообщение(0);</span></p>
  <p><span class="src">Текст=Почта.Текст; </span></p>
  <p><span class="src"><b> </b>Пока Почта.ПолучитьФайл(ПутьКФайлу, ИмяФайла) = 
    1 Цикл</span></p>
  <p><span class="src">ТекстДок.Открыть(ПутьКФайлу+ИмяФайла);</span></p>
  <p><span class="src">ТекстДок.ТолькоПросмотр(1);</span></p>
  <p><span class="src">ТекстДок.Показать(Заголовок);</span></p>
  <p><span class="src">КонецЦикла; </span></p>
  <p><span class="src">КонецЦикла; </span></p>
  <p><span class="src">Почта.Отключиться();</span></p>
  <p><span class="src">КонецПроцедуры</span></p>
  <h3> <a name="_Toc502239092">Особенности работы с различными клиентами MAPI.</a></h3>
  <p>Работа объекта V7Mail компоненты проверялась со следующими  программами:</p>
  <h4> <a name="_Toc502239093">Outlook </a>Express 5.0.</h4>
  <p>Не нужно задавать конфигурацию подключения - всегда  выбирается конфигурация, 
    заданная по умолчанию в Internet  Accounts (меню Tools-&gt;Accounts, закладка 
    Mail).</p>
  <h4><span> </span><a name="_Toc502239094">Outlook 97.</a></h4>
  <p>При отправке сообщения необходимо перед адресом добавлять  &quot;SMTP:&quot; 
    (например - SMTP:xxxxxx@ru);</p>
  <h4> <a name="_Toc502239095">Outlook 2000.</a> </h4>
  <p>1. При отправке сообщения необходимо перед адресом добавлять  &quot;SMTP:&quot; 
    (например - SMTP:xxxxxx@ru);</p>
  <p>2. Если E-Mail сервис сконфигурирован как &quot;Internet Only&quot;, то  
    прием и отправка сообщений происходит только при запущенном  Outlook 2000. 
    Рекомендуется использовать конфигурацию  &quot;Corporate or Workgroup&quot;, 
    которая не требует для работы с  сообщениями запущенного Outlook 2000.</p>
  <h4> <a name="_Toc502239096">Netscape Messenger.</a></h4>
  <p>При приеме с помощью объекта V7Mail сообщений, содержащих  присоединенные 
    файлы, эти файлы  оказываются в составе  текста сообщения. Отправка сообщений 
    проходит нормально.</p>

</body>
</html>

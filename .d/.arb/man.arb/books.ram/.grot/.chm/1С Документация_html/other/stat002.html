<HTML>
<HEAD>
<TITLE>1С-Предприятие. Документация. Статья | Маленькие хитрости администрирования 
баз данных программ семейства "1С-Предприятие"</TITLE>
<meta http-equiv=Content-Type content="text/html; charset=koi8-r">
<link rel="stylesheet" type="text/css" href="../1c.css">
</HEAD>

<body background="../images/background_main.gif">
<h1 align="left">Маленькие хитрости администрирования баз данных программ семейства 
  "1С:Предприятие"</h1>

<P><A href="mailto:stm62@comset.net">Владимир Козлов</A>, ICQ/UIN 26870123</P>

<FONT SIZE=2><P>&nbsp;</P>
</FONT><FONT FACE="Times New Roman" SIZE=5><P>Введение</P>
</FONT><P><FONT FACE="Times New Roman">&#9;Очень часто в различных электронных конференциях по программам семейства "1С:Предприятие" попадаются вопросы, связанные с администрированием баз данных. Желание поделиться опытом, накопленным почти</font> <FONT FACE="Times New Roman">за три года работы и обкатанными приемами в данной области с одной стороны и природная лень - с другой (в смысле надоело раз от разу отвечать на одни и те же вопросы</FONT>) <FONT FACE="Times New Roman">и вызвало желание как-то систематизировать все это в одном - общедоступном месте. Все нижеизложенное касается программ сетевой файл-серверной версии 7.5 (на 7.7 и </FONT>SQL <FONT FACE="Times New Roman">я только вот-вот перейду), т.ч. в случае использования более старших версий </FONT>(<FONT FACE="Times New Roman">как и </FONT>SQL <FONT FACE="Times New Roman">версий) возможно потребуется некая адаптация кода : Кроме этого подразумевается, что читатель хотя бы поверхностно знаком с компьютерной техникой, сетями, </FONT>c <FONT FACE="Times New Roman">основами </FONT>MS Windows<FONT FACE="Times New Roman"> и основами работы с программой "1С:Предприятие". Приводимый в прилагаемых конфигурациях код не "привязан" к какой-то отдельной компоненте программы (Оперативный учет, Бухгалтерия, Расчет), а потому может быть использован в любых конфигурациях.</font></P>
<P><FONT FACE="Times New Roman" SIZE=5>Общие сведения (</font><FONT SIZE=5>v.7.5)</font></P>
<P><FONT FACE="Times New Roman">&#9;Итак, вы распаковали увесистую желто-красную коробочку с логотипом 1С :, что же дальше? Как и какую вязать сеть, что для этого нужно и прочие технические вопросы мы здесь рассматривать не будем - это отдельная тема - предположим, что сеть уже есть : Также не будем останавливаться на процедуре инсталляции программы 1С, как правило здесь вопросов не возникает. Единственное, что хочется отметить - я бы не советовал производить "административную" установку программы (сугубо личное мнение, наверняка у меня тут же найдутся оппоненты). Проще установить программу локально каждому клиенту - мне кажется, что такой режим более "человечен" по отношению к сетевому</font> <FONT FACE="Times New Roman">трафику. Хочу сразу же предостеречь - для работы в сети каталог базы данных лучше разместить на специально отведенном для этих целей компьютере - сервере. По возможности не следует нагружать его еще чем-либо (типа </FONT>MS Office)<FONT FACE="Times New Roman">, т.е. сделать "выделенным", также следует помнить, что тактико-технические характеристики данного аппарата напрямую влияют на комфортность вашей работы, поэтому жаться здесь не стоит. Что выбрать в качестве операционной системы для вашего сетевого файл-сервера базы данных? Однозначный ответ - ни в коем случае не </FONT>Microsoft Windows 9X ! <FONT FACE="Times New Roman">Дело в том, что у этих операционных систем существует ограничение на число одновременно открываемых файлов (1К: 1024) - в результате с таким "сервером" в сети смогут работать лишь несколько пользователей (конкретное количество зависит от числа файлов в конфигурации вашей базы). Лично я предпочитаю пользоваться системой </FONT>Microsoft NT 4.0<FONT FACE="Times New Roman">. Если вы уверены, что число клиентов вашей сети не превысит 10, то можно установить на сервер </FONT>NT Workstation (<FONT FACE="Times New Roman">большее число соединений ей просто не поддерживается), в противном случае не обойтись без </FONT>NT Server. <FONT FACE="Times New Roman">В качестве альтернативы для серверной системы можно использовать и </FONT>Nowell Netware<FONT FACE="Times New Roman">, но я с ней к сожалению (или быть может к счастью) не знаком, поэтому ничего посоветовать не могу : Также уже начали появляться первые восторженные отзывы об использовании долгожданной </FONT>Windows 2000 (NT 5) <FONT FACE="Times New Roman">в связке с 1С, но мне кажется не стоит торопить события, 17 февраля уже не за горами, поживем - увидим.</font></P>
<P>
<FONT SIZE=2>&#9;</font><FONT FACE="Times New Roman">Для начала приведу ключи запуска программы из командной строки (как не странно, много раз с удивлением убеждался, что не всем они известны) :</font></P>

<P>&#9;<I>1cv7.exe MODE [ /M | /D&lt;Path&gt; | /U&lt;Path&gt; | /N&lt;Name&gt; | /P&lt;Pass&gt; ]</I>,</P>

<P><FONT FACE="Times New Roman">где </FONT>MODE - <FONT FACE="Times New Roman">режим запуска, может принимать только одно из трех значений :</font></P>
<P><I>config</I> - <FONT FACE="Times New Roman">режим конфигуратора;</font></P>
<P><I>debug</I> - <FONT FACE="Times New Roman">режим отладчика;</font></P>
<P><I>enterprise</I> -<FONT FACE="Times New Roman"> нормальный (рабочий) режим.</font></P>

<FONT FACE="Times New Roman"><P>следующие ключи опциональны :</P>
</FONT><P><I>/M</I><FONT FACE="Times New Roman"> - запуск программы в монопольном режиме;</font></P>
<P><I>/D</I> - <FONT FACE="Times New Roman">каталог базы данных;</font></P>
<P><I>/U</I> - <FONT FACE="Times New Roman">рабочий каталог пользователя (каталог из списка пользователей игнорируется);</font></P>
<P><I>/N</I> - <FONT FACE="Times New Roman">имя пользователя;</font></P>
<P><I>/P</I> - <FONT FACE="Times New Roman">пароль пользователя;</font></P>

<P><FONT FACE="Times New Roman">Например при выполнении такой команды : </font><I>1cv7 enterprise /DD:\Dbase /N<FONT FACE="Times New Roman">Иванов </FONT>/P123,</i></P>
<FONT FACE="Times New Roman"><P>произойдет запуск программы без вывода диалогов о выборе базы и режима работы, а также без запроса имени и пароля пользователя.</P>
</FONT>
<P><FONT FACE="Times New Roman">&#9;Также хочу здесь остановиться еще на одном нюансе. В режиме кофигуратора в пункте меню "Файл" есть две команды : "Выгрузить данные" и "Загрузить данные"</font> (<FONT FACE="Times New Roman">не путать с командами</FONT> <FONT FACE="Times New Roman">"Сохранить/Восстановить</FONT>" -<FONT FACE="Times New Roman"> это просто архивирование). Исходно они предназначены для переноса информационных баз между файл-серверной и клиент-серверной (</FONT>SQL)<FONT FACE="Times New Roman"> версиями. Но у них есть одна приятная особеннось - в процессе выгрузки - загрузки производится верификация корректности исходных данных на уровне информационных объектов (т.е. констант, справочников, документов и пр.). Поэтому если в базе содержатся ошибки, появившиеся в процессе работы из-за сбоев оборудования или программы, при выполнении данной процедуры база с большой долей вероятности будет корректно восстановлена. Так что в процессе работы полезно периодически производить сие действие для уверенности в корректности данных (хотя данная процедура занимает порядка нескольких десятков минут - в зависимости от железа и объемов базы) - я обязательно выполняю ее раз в месяц. Кроме этого желательно почаще переиндексировать базу (особенно если есть документы, проведенные "задним числом") - напрочь сносим </FONT>*.CDX<FONT FACE="Times New Roman"> и открываем базу в монопольном режиме, у меня это делается автоматически каждую ночь.</font></P>
<P>&#9;</P>
<FONT FACE="Times New Roman"><P>Поскольку все пользователи в сети работают с базой в режиме реального времени, то необходимо при включении клиентских компьютеров выполнять синхронизацию их таймеров с таймером сервера - у меня в автозагрузке на клиентах выполняется следующий командный файл :</P>
</FONT><B><FONT FACE="Courier New" SIZE=2><P></P>
<P>@ECHO OFF</P>
<P>NET TIME \\Server /SET /Y</P>
</font></B><P></P>
<P><FONT FACE="Times New Roman">(здесь </font>Server - <FONT FACE="Times New Roman">сетевое имя сервера базы)</font></P>
<P><FONT FACE="Times New Roman" SIZE=5>Подальше положишь </font><FONT SIZE=5>-</FONT><FONT FACE="Times New Roman" SIZE=5> поближе возьмешь </FONT><FONT SIZE=5>:</font></P>
<P><FONT FACE="Times New Roman">Регулярно  выполнять</font> <FONT FACE="Times New Roman">резервное архивирование</FONT> <FONT FACE="Times New Roman">нужно обязательно, чтобы не было потом обидно за безвозвратно утерянные данные. Чем это делать - это вопрос скорее вкуса. Существует например специально "заточенная" под 1С программа "Хранитель" от ростовской фирмы "Гендальф" </FONT><A href="http://www.gendalf.ru/index.html"><U>http://www.gendalf.ru/</U></A><FONT FACE="Times New Roman">, которая умеет делать массу полезных вещей, но мне она кажется слишком перегруженной для таких простых целей, я пользуюсь старым добрым </FONT>RAR'<FONT FACE="Times New Roman">ом. Архивировать следует только файлы базы</FONT> *.dbf <FONT FACE="Times New Roman">и сами метаданные </FONT>(1cv7.dd/md)<FONT FACE="Times New Roman">, ну еще </FONT>LOG-<FONT FACE="Times New Roman">файл и ваши оригинальные файлы (если они есть). Сначала приведу содержимое нескольких командных файлов </FONT>(<FONT FACE="Times New Roman">расширение </FONT>*.cmd <FONT FACE="Times New Roman">работает только под Win NT, если используется Win'9X, то расширение должно быть *.</FONT>bat):</P>
<P></P>
<B><I><FONT FACE="Courier New"><P>ARCH.CMD</P>
</font></i></B><P><FONT FACE="Courier New" SIZE=2>REM </font><FONT FACE="Courier New" SIZE=2>используемые каталоги (должны существовать)</font></P>
<P><FONT FACE="Courier New" SIZE=2>REM &#9;D:\1C\DB - </font><FONT FACE="Courier New" SIZE=2>рабочая база</font></P>
<P><FONT FACE="Courier New" SIZE=2>REM C:\Temp\DB - </font><FONT FACE="Courier New" SIZE=2>временная копия базы</font></P>
<P><FONT FACE="Courier New" SIZE=2>REM C:\BACKUP - </font><FONT FACE="Courier New" SIZE=2>архив базы</font></P>
<P><FONT FACE="Courier New" SIZE=2>REM \\Adm\Storage - </font><FONT FACE="Courier New" SIZE=2>резервный архив базы (на другом компьютере сети)</font></P>
<FONT FACE="Courier New" SIZE=2><P></P>
<B><P>@echo off</P>
</B></FONT><FONT FACE="Courier New" SIZE=2><P>; чистим временный каталог</P>
</FONT><B><P><FONT FACE="Courier New" SIZE=2>Del  </font><FONT FACE="Courier New" SIZE=2>С</FONT><FONT FACE="Courier New" SIZE=2>:\Temp\DB\*.*</font></P>
</B><P><FONT FACE="Courier New" SIZE=2>; копируем в него архивируемые файлы рабочей базы</font><FONT FACE="Courier New" SIZE=2> (*.md,*.dd,*.log,*dbf)</font></P><FONT FACE="Courier New" SIZE=2>
</FONT><P><B><FONT FACE="Courier New" SIZE=2>Copy D:\1</font></b><B><FONT FACE="Courier New" SIZE=2>С</FONT><FONT FACE="Courier New" SIZE=2>\DB\1cv7* </FONT><FONT FACE="Courier New" SIZE=2>С</FONT><FONT FACE="Courier New" SIZE=2>:\Temp\DB</font></b></P><B><FONT FACE="Courier New" SIZE=2>
<P>Copy D:\1C\DB\*.dbf C:\Temp\DB</P>
</font></B><FONT FACE="Courier New" SIZE=2><P>; сохраняем предыдущую версию архива под новым именем</P>
</FONT><B><FONT FACE="Courier New" SIZE=2><P>copy C:\BACKUP\db.rar C:\BACKUP\db0.rar</P>
</font></B><FONT FACE="Courier New" SIZE=2><P>; создаем новый архив</P>
</FONT><B><P><FONT FACE="Courier New" SIZE=2>rar.exe u -r -m1 -dh -std C:\BACKUP\db.rar </font><FONT FACE="Courier New" SIZE=2>С</FONT><FONT FACE="Courier New" SIZE=2>:\Temp\DB\*.*</font></P><FONT FACE="Courier New" SIZE=2>
<P>if errorlevel 0 goto rpl</P>
<P>echo P_A_C_K_I_N_G___E_R_R_O_R__!</P>
<P>goto end</P>
<P>:rpl</P>
</font></B><FONT FACE="Courier New" SIZE=2><P>; сохраняем копию архива в надежном месте</P>
</FONT><B><FONT FACE="Courier New" SIZE=2><P>net use Z: \\Adm\Storage</P>
<P>copy C:\BACKUP\*.rar Z:</P>
<P>net use Z: /delete</P>
<P>:end</P>
</font></B><FONT SIZE=2><P></P>
</FONT><FONT FACE="Times New Roman"><P>Выполнять сию процедуру можно не прерывая производственного процесса (никого из базы выгонять не надо), именно для этого мы архивируем не саму базу, а ее временную копию.</P>
</FONT><P><FONT FACE="Times New Roman">На этом все, осталось всего навсего запустить системную службу </font>S<FONT FACE="Times New Roman">с</FONT>hedule: Explorer-ControlPanel-Services-Schedule-Startup-Automatic <FONT FACE="Times New Roman">(поддерживается только под </FONT>Win NT<FONT FACE="Times New Roman">, для </FONT>Win'9X <FONT FACE="Times New Roman">нужны специальные внешние утилиты) и набрать из командной строки что-нибудь аналогичное :</font></P>
<B><FONT FACE="Courier New" SIZE=2><P></P>
<P>At 13:00 /Every:M,T,W,Th,F C:\COMMAND\arch.cmd</P>
<P>At 18:00 /Every:M,T,W,Th,F C:\COMMAND\arch.cmd</P>
<P>At 07:00 /Every:M,T,W,Th,F C:\COMMAND\shutdown /l /r /y /c</P>
<P></P>
</font></B><FONT FACE="Times New Roman"><P>и все - мы имеем два раза в день автоматическое архивирование нашей базы, ежедневно - с понедельника по пятницу. По-моему просто и самодостаточно. Как часто нужно делать архивы - это зависит от интенсивности документооборота в вашей организации, я делаю два раза в день, т.ч. если что, то придется восстанавливать документы максимум за пол-дня (тьфу-тьфу):</P>
</FONT><P><FONT FACE="Times New Roman">Теперь о третьей строке в команде </font>AT - <FONT FACE="Times New Roman">в плане автоматизиции рутинных действий я пошел еще дальше, как я уже упоминал у меня каждую ночь производится реиндексация базы, для этого используется такой командный файл :</font></P>

<B><I><FONT FACE="Courier New"><P>REINDEX.CMD</P>
</font></I><FONT FACE="Courier New" SIZE=2><P>@echo off</P>
</font></B><FONT FACE="Courier New" SIZE=2><P>; каталог базы</P>
</FONT><P><B><FONT FACE="Courier New" SIZE=2>set db=D:\1С\</font></b><B><FONT FACE="Courier New" SIZE=2>DB</font></b></P>
<FONT FACE="Courier New" SIZE=2><P>; каталог программы</P>
</FONT><B><FONT FACE="Courier New" SIZE=2><P>set pr="C:\Program Files\1cv75\bin\1cv7"</P>
</font></B><FONT FACE="Courier New" SIZE=2><P>; принудительно сносим индексы</P>
</FONT><B><FONT FACE="Courier New" SIZE=2><P>del %db%\*.cdx /Q</P>
</font></B><FONT FACE="Courier New" SIZE=2><P>; запускаем программу монопольно под "фиктивным" пользователем</P>
</FONT><B><P><FONT FACE="Courier New" SIZE=2>%pr% enterprise</font><FONT FACE="Courier New" SIZE=2> /D%db% /M /NЧистяков /P</FONT><FONT FACE="Courier New" SIZE=2>start</font></P><FONT FACE="Courier New" SIZE=2>
<P></P>
</font></B><P><FONT FACE="Times New Roman">Этот командный файл вставляется в папку автозагрузки на сервере, утилита </font>SHUTDOWN.EXE (<FONT FACE="Times New Roman">из </FONT>Windows NT Resource Kit - <FONT FACE="Times New Roman">это набор дополнительных сервисных утилит</FONT>)<FONT FACE="Times New Roman"> производит перезагрузку сервера, для того чтобы по загрузке не нажимать магическую комбинацию из трех пальцев (</FONT>Ctrl-Alt-Del) <FONT FACE="Times New Roman">и не вводить пароль, а загрузить сервер автоматически, нужно подправить системный реестр </FONT>NT (<FONT FACE="Times New Roman">запустить из командной строки </FONT>regedit.exe) :</P>
<B><FONT FACE="Courier New" SIZE=2><P></P>
<P>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon]</P>
<P>"DefaultUserName"="YourProfileName"</P>
<P>"DefaultDomainName"="Comp"</P>
<P>"AutoAdminLogon"="1"</P>
<P>"DefaultPassword"="YourPass"</P>
</FONT></B>
<P><FONT FACE="Times New Roman">где </font><B><FONT FACE="Courier New" SIZE=2>YourProfileName - </font></B><FONT FACE="Times New Roman">имя профиля администратора на сервере (по умолчанию </FONT>Administrator), <B><FONT FACE="Courier New" SIZE=2>Comp - </font></B><FONT FACE="Times New Roman">сетевое имя сервера, </FONT><B><FONT FACE="Courier New" SIZE=2>YourPass - </font></B><FONT FACE="Times New Roman">пароль аминистратора на сервере (обязательно должен быть не пустым).</font></P>
<P></P>
<P><FONT FACE="Times New Roman">Итак подъитожим - в заданное нами время происходит автоматическая перезагрузка сервера с переиндексацией базы, для того чтобы программа по окончании переиндексации сама завершилась необходимо в глобальном модуле конфигурации предусмотреть некие нестандартные действия по обработке входа в программу исскуственного "фиктивного" пользователя (Чистяков</font> -<FONT FACE="Times New Roman"> без пароля) - они приведены в демонстрационной конфигурации (архив </FONT><A href="file:///c_7c/!distr/1c/_c4_ee_ea_f3_ec_e5_ed_f2_e0_f6_e8_ff/files/adm.rar"><U><FONT SIZE=2>Adm.rar</font></U></A>).</P>
<P><FONT FACE="Times New Roman">В принципе никто не запрещает пойти еще дальше - и наряду с переиндексацией базы по ночам выполнять любые желаемые действия, например групповое перепроведение документов для восстановления границы последовательности или формирование "тяжеловесных" отчетов, с последующим сохранением их результатов в *.</font>mxl <FONT FACE="Times New Roman">файлах, рассылки прайсов по факсу или </FONT>e-mail'<FONT FACE="Times New Roman">у и т.д. Все ограничивается только вашей фантазией.</font></P>
<P><FONT FACE="Times New Roman" SIZE=5>Уборка мусора в </font><FONT SIZE=5>DBF-</FONT><FONT FACE="Times New Roman" SIZE=5>файлах</font></P>
<P><FONT FACE="Times New Roman">Идеология использования </font>DBF/CDX<FONT FACE="Times New Roman">-файлов построена таким образом, что при удалении объекта базы производится только пометка объекта как удаленного, физически же запись об этом объекте остается в базе в качестве "мусора". Если не предпринимать никаких специальных мер, то этот мусор копится, база пухнет, драгоценный сетевой трафик забивается зря. В принципе "уборку мусора" можно производить в конфигураторе через выгрузку-загрузку данных, но это не очень удобно, поскольку, как я уже упоминал выше, выполнение данной процедуры может требовать значительных временных затрат: Альтернативный путь - использовать для этих целей внешние утилиты, предназначенные для работы с </FONT>DBF/CDX<FONT FACE="Times New Roman">-файлами (например утилитка </FONT>DBU.EXE <FONT FACE="Times New Roman">из </FONT>Clipper'<FONT FACE="Times New Roman">а) тоже не очень хорош, т.к. обычно они не умеют работать с маской файлов (*.</FONT>dbf)<FONT FACE="Times New Roman">, а "подсовывать" им по одному файлу из сотни - удовольствие ниже среднего.</font></P><P>
<FONT FACE="Times New Roman">В тоже время встроенный язык программ "1С:Предприятия" поддерживает соответствующий </font>DBF-<FONT FACE="Times New Roman">примитив (метод объекта </FONT>Xbase <FONT FACE="Times New Roman">Сжать()), поэтому я в свое время и написал на 1С небольшую конфигурацию, предназначенную исключительно для этих целей и пользуюсь ей регулярно до сих пор (раз в неделю). Кроме "чистки" базы в ней также попутно предусмотрена возможность использования стандартного внешнего архиватора </FONT>WinZip/WinRAR <FONT FACE="Times New Roman">для архивирования базы, собственно сама конфигурация в архиве </FONT><A href="file:///c_7c/!distr/1c/_c4_ee_ea_f3_ec_e5_ed_f2_e0_f6_e8_ff/files/cleaner.rar"><U><FONT SIZE=2>Cleaner.rar</font></U></A><FONT FACE="Times New Roman">, небольшое описание приведено в этом же архиве в файле </FONT>Read.me.</P>
<P><FONT FACE="Times New Roman" SIZE=5>Есть кто живой ?</font> </P>
<P><FONT FACE="Times New Roman">&#9;Как известно, в состав сетевых версий программы 1С:Предприятие входит встроенная утилитка - монитор пользователей</font> (<FONT FACE="Times New Roman">пункт главного меню программы "Помощь", далее пункт меню "О программе" и кнопка "Монитор"), назначение ее очевидно - отображать кто в данный момент находится в системе, причем реализована она как внешнее приложение (</FONT>..\1cv75\bin\usrmon.exe)<FONT FACE="Times New Roman">. В свое время, на ранних релизах версии 7.5 я столкнулся с крайне неудовлетворительной работой данной утилиты - либо безумно долго запускалась, либо вообще убивала систему. Но ведь вещь то нужная и я решил построить что-то аналогичное средствами 1С.</font></P><FONT FACE="Times New Roman">
<P>Идея проста - я завел новый справочник "Сеансы", у которого текстовое поле код - это имя пользователя, а наименование - текстовое представление времени входа в систему.</P>
</FONT><P><FONT FACE="Times New Roman">Далее, при входе каждого нового пользователя в программу создается новый элемент данного справочника, при выходе - соответстветствующий элемент уничтожается. Теперь для того чтобы узнать кто работает в программе, нам достаточно просто выбрать все элементы данного справочника и отобразить их в удобном виде. Подробный код, реализующий данный механизм можно найти во все той же демонстрационной конфигурациии - </font><A href="file:///c_7c/!distr/1c/_c4_ee_ea_f3_ec_e5_ed_f2_e0_f6_e8_ff/files/adm.rar"><U><FONT SIZE=2>adm.rar</font></U></A>.</P>
<P><FONT FACE="Times New Roman">&#9;Опять же, при таком подходе можно пойти дальше - добавить дополнительные поля в данный справочник и хранить в них все что заблагорассудится. К примеру, год назад у меня были проблемы с сетью, почти ежедневно кто-то из пользователей аварийно отваливался, нужно было как-то автоматически отслеживать кто именно. Я добавил к данному справочнику поле, в которое один раз в 15 минут для каждого пользователя записывалось текущее время (делалось это в глобальном модуле через процедуру ОбработкаОжидания(), т.е. если пользователь умирал, то запись соответственно не производилась). Перед каждой записью из элемента справочника считывалось предыдущее значение времени и если разница между ним и текущим значением времени превышала 18 минут (15 мин. + некий запас), то констатировался факт "смерти" пользователя с сохранением некролога в </font>LOG<FONT FACE="Times New Roman"> файл. Это в свое время помогло съэкономить мне массу сил и нервов - не пришлось допрашивать с пристрастием бедных пользователей "А корректно ли вы сегодня закончили работу ?" и сверять результаты допроса с содержимым </FONT>LOG-<FONT FACE="Times New Roman">файла - подсчитывать для каждого пользователя число входов/выходов в/из систему/системы:</font></P>
<P><FONT FACE="Times New Roman" SIZE=5>Как поняли, прием :</font> </P>
<P><FONT FACE="Times New Roman">Часто бывает крайне полезно иметь под рукой средства интерактивного общения по сети, например, попросить всех "выйти вон" на 5 мин. для переиндексации базы, или пользователь просит меня открыть ему доступ для авансового резервирования товара (выписать счет на товар, который уже пришел, но еще не оприходован), в конце концов просто послать кого-нибудь куда подальше : Штатные средства, предназначенные для этих целей (</font>WinPopUp <FONT FACE="Times New Roman">и пр.)</FONT> <FONT FACE="Times New Roman">не всегда удобны - они должны быть установлены и запущены у всех клиентов  - в общем морока.</font></P><P>
<FONT FACE="Times New Roman">Общеизвестно, что в типовых конфигурациях Торговли, по-моему начиная с Редакции 6, появился справочник "Блокнот", предназначенный именно для этих целей. Но моя реализация мне нравится больше, к тому же на момент ее написания - не только 6, но и Редакции 5 еще в помине не было. Ну а насколько я объективен - судить вам. Суть в следующем  - есть справочник "Сообщения" со следующими полями : "Наименование" - адресат сообщения, "Запись" - собственно текст сообщения, "Прочитано" - флаг 1/0 (дошло до адресата или нет), "Кто" - отправитель сообщения и "ДВ" - дата и время отправки. Для каждого активного пользователя системы (опять же нам здесь пригодился справочник "Сеансы") каждые 30 секунд перебираются элементы справочника "Сообщения", в случае совпадения имени пользователя и значения поля "Адресат</font>"<FONT FACE="Times New Roman"> и нулевого значения флага "Прочитано", выводится сообщение "Вам письмо!" и открывается соответствующая форма с текстом сообщения. По закрытии данной формы, что предполагает прочтение адресатом сообщения, флаг "Прочитано" автоматически устанавливается в 1</FONT>.<FONT FACE="Times New Roman"> При выходе пользователя из системы все прочитанные им сообщения автоматически удаляются. Каждый "обычный" пользователь может послать сообщение только одному из пользователей, активных в данный момент. И только администратор (для себя любимого возможность</FONT>)<FONT FACE="Times New Roman"> может послать сообщение для всех пользователей сразу. Такая организация кажется мне наиболее оптимальной исходя из  соотношения сервисные возможности  / загрузка трафика. Реализация приведена все в той же конфигурации - </FONT><A href="file:///c_7c/!distr/1c/_c4_ee_ea_f3_ec_e5_ed_f2_e0_f6_e8_ff/files/adm.rar"><U><FONT SIZE=2>adm.rar</font></U></A>.</P>
<P><FONT FACE="Times New Roman" SIZE=5>Кому-то можно, кому-то нет </font><FONT SIZE=5>:</font></P>
<P><FONT FACE="Times New Roman">Достаточно часто встречаются вопросы, а как производить авторизацию пользователей с одинаковым набором прав </FONT>-<FONT FACE="Times New Roman"> скажем есть 5 менеджеров и желательно сделать так, чтобы доступ у каждого из них был только к своим документам. Это делается достаточно просто </FONT>-<FONT FACE="Times New Roman"> при помощи предопределенных процедур глобального модуля ПриУдалении() и ПриОтменеПроведения(), все это совершенно очивидно из кода демонстрационной конфигурации</FONT> <A href="file:///c_7c/!distr/1c/_c4_ee_ea_f3_ec_e5_ed_f2_e0_f6_e8_ff/files/adm.rar"><U><FONT>adm.rar</font></U></A>, <FONT FACE="Times New Roman">поэтому задерживаться на этом не буду. Еще один момент </FONT>-<FONT FACE="Times New Roman"> мне кажется довольно удобным, когда  каждому пользователю</FONT> <FONT FACE="Times New Roman">соответствует свой цифровой префикс</FONT> <FONT FACE="Times New Roman">(точнее его часть) в нумерации документов</FONT> (<FONT FACE="Times New Roman">конечно же при условии</FONT>,<FONT FACE="Times New Roman"> что пользователей не очень много). Механизм реализации этого можно посмотреть там же </FONT>:</P>
<P><FONT FACE="Times New Roman" SIZE=5>Ссылки на полезный софт (всякие всякости)</font> </P>
<P><FONT FACE="Times New Roman">&#9;Поскольку все наши данные хранятся в формате </font>DBF/CDX<FONT FACE="Times New Roman">, очень часто бывает полезно, а порой и просто необходимо средство для просмотра / редактирования данных на уровне файлов. Таких утилит существует множество, единственный недостаток - не все из них умеют сами разбираться с перекодировкой </FONT>ANSI-OEM (<FONT FACE="Times New Roman">да еще и с кириллицей), в этом смысле самая на мой взгляд удобная - это </FONT>DBFView <FONT FACE="Times New Roman">от фирмы "Гендальф", скачать ее можно совершенно бесплатно здесь:
</FONT><A href="http://www.gendalf.ru/download/wdbfview.zip"><U><FONT SIZE=2>http://www.gendalf.ru/DOWNLOAD/wDBFview.zip</font></U></A></P>
<P><FONT FACE="Times New Roman">&#9;Теперь остановимся подробнее на собственно средствах системного сетевого администрирования. Их сейчас появилось очень много, поэтому здесь я упомяну только те, с которыми я сам постоянно работаю и которые мне нравятся. Начну пожалуй со своей любимой программы </font>Hyena <FONT FACE="Times New Roman">от фирмы </FONT>"Adkins Resource Inc." <A href="http://www.asdkins-resource.com/index.html"><U><FONT SIZE=2>http://www.asdkins-resource.com/</font></U></A>. <FONT FACE="Times New Roman">Пожалуй проще перечислить чего она не умеет, чем наоборот : С ее помощью вы сможете получить полный доступ к локальным дискам клиентов, просматривать журналы событий на компьютерах сети, запускать и останавливать </FONT>service'<FONT FACE="Times New Roman">ы на клиентах, изменять их права, ну в общем почти все что может придти в голову. В общем настоятельно ее рекомендую. Да, стоит упомянуть, что как и положено, работает она только с </FONT>Windows NT 4 / 2000<FONT FACE="Times New Roman">, т.ч. любителям </FONT>Windows 9X <FONT FACE="Times New Roman">можно не беспокоиться</FONT>. <FONT FACE="Times New Roman">Достойны также пристального внимания продукты, предназначенные для целей сетевого администрирования фирмы </FONT>"Aelita Software" <A href="http://aelita.net/index.html"><U><FONT SIZE=2>http://aelita.net/</font></U></A>. <FONT FACE="Times New Roman">Их целый ряд, на мой взгляд наиболее полезны</FONT> MultiReg - <FONT FACE="Times New Roman">средство для удаленного редактирования системного реестра клиента, </FONT>EventAdmin <FONT FACE="Times New Roman">и </FONT>Journal - <FONT FACE="Times New Roman">база данных для накопления и последующего анализа системных журналов событий на клиентских машинах, ну и пожалуй еще </FONT>ERDisk - <FONT FACE="Times New Roman">утилита для создания копий загрузчиков и системных файлов сетевых клиентов (в случае </FONT>"Blue Screen of Death" - <FONT FACE="Times New Roman">это первое и, пожалуй единственное средство)</FONT>. <FONT FACE="Times New Roman">Все эти продукты также поддерживают только </FONT>Windows NT. </P>
<P><FONT FACE="Times New Roman">&#9;В последнее время появился целый ряд программ для полного удаленного доступа к сетевым компьютерам. Собственно</font> Norton pcAnywere<FONT FACE="Times New Roman"> создан давно и достаточно хорошо известен, но он не является лучшим продуктом этого класса. Я экспериментировал с двумя аналогичными программами </FONT>-<FONT FACE="Times New Roman"> это </FONT>WinOp (<FONT FACE="Times New Roman">отдельное большое спасибо </FONT>BigHarry) <FONT FACE="Times New Roman">фирмы </FONT>"Danware A/S" <A href="http://www.danware.com/index.html"><U><FONT SIZE=2>http://www.danware.com/</font></U></A> <FONT FACE="Times New Roman">и </FONT>Remoute Administrator <FONT FACE="Times New Roman">нашего соотечественника  Дмитрия Зноско</FONT> <A href="http://www.famatech.com/index.html"><U><FONT SIZE=2>http://www.famatech.com/</font></U></A>, <FONT FACE="Times New Roman">функциональные возможности у них примерно одинаковые, но первая мне нравится больше, мне показалась</FONT>,<FONT FACE="Times New Roman"> что она более разумно обходится с сетевым трафиком, т.ч. я работаю с ней. Что</FONT> <FONT FACE="Times New Roman">же она умеет, а почти все </FONT>-<FONT FACE="Times New Roman"> поддерживает все сетевые протоколы от </FONT>Microsoft, <FONT FACE="Times New Roman">включая </FONT>MSDN<FONT FACE="Times New Roman"> и модемный </FONT>Dial-Up (<FONT FACE="Times New Roman">чуствуете какие перспективы открываются для ленивых админов!). Программа состоит из двух компонент </FONT>- host (<FONT FACE="Times New Roman">устанавливается на клиентов) и </FONT>guest (<FONT FACE="Times New Roman">ставится на компьютер администратора). Причем клиентская часть под </FONT>WinNT <FONT FACE="Times New Roman">может устанавливаться как </FONT>service <FONT FACE="Times New Roman">в </FONT>stealth-<FONT FACE="Times New Roman">режиме, абсолютно прозрачно для клиента. При запуске </FONT>guest'<FONT FACE="Times New Roman">а и подключении к клиенту вы видите на своем мониторе его экран, ваши клава и мышь работают как клиентские, т.е. доступ действительно полный ! Более того</FONT>, <FONT FACE="Times New Roman"> вы можете погасить экран клиента, заблокировать его клаву и мышь и даже удаленно перезагрузить его компьютер </FONT>:<FONT FACE="Times New Roman"> Есть еще такие вещи как</FONT> chat, <FONT FACE="Times New Roman">файловый обмен и пр. В общем штука чрезвычайно полезная. Работает быстро и надежно (и кстати поддерживает </FONT>Windows 9X/3.1). <FONT FACE="Times New Roman">Единственное хочу предостеречь от злоупотреблений </FONT>-<FONT FACE="Times New Roman"> трафик то не резиновый, т.е. пользоваться ей нужно только тогда, когда это действительно необходимо.</font></P><P>
<FONT FACE="Times New Roman">&#9;Итак подъитожим </font>-<FONT FACE="Times New Roman"> используя все эти средства у сисадмина появляются реальные возможности для проведения своего рабочего времени целиком у родного компьютера, беготня по клиентам канула в лету </FONT>:</P>
<P><FONT FACE="Times New Roman">&#9;Ну и напоследок хочу привести несколько полезных ссылок на различные </font>FAQ'<FONT FACE="Times New Roman">и по </FONT>Windows NT :</P>
<P><A href="http://www.ntfaq.com/index.html"><U><FONT SIZE=2>http://www.ntfaq.com/</font></U></A> - <FONT FACE="Times New Roman">это классика</FONT>, FAQ <FONT FACE="Times New Roman">от </FONT>John Savill (<FONT FACE="Times New Roman">кстати там есть и локальный вариант, т.е. можно скачать файл (</FONT>html/hlp/txt) <FONT FACE="Times New Roman">и штудировать его в </FONT>off-line)<FONT FACE="Times New Roman">, здесь можно найти ответы на абсолютно любые вопросы</FONT>;</P>
<P><A href="http://www.pvv.spb.ru/index.html"><U><FONT SIZE=2>http://www.pvv.spb.ru/</font></U></A> - <FONT FACE="Times New Roman">очень приятный и полезный для любого компьютерщика русский </FONT>FAQ<FONT FACE="Times New Roman"> по </FONT>Windows 9X/NT/2000 <FONT FACE="Times New Roman">от Владислава Пестова, настоятельно рекомендую;</font></P>
<P><A href="http://windowsnt.miningo.com/mlibrary.htm"><U><FONT SIZE=2>http://windowsnt.miningo.com/mlibrary.htm</font></U></A> - <FONT FACE="Times New Roman">это просто огромный каталог всего</FONT> (<FONT FACE="Times New Roman">ресурсы, публикации, ссылки на сайты и т.д.)</FONT>,<FONT FACE="Times New Roman"> что связано с </FONT>WinNT.</P>
<B><I><FONT SIZE=4>
</FONT></i></B><P><I><B><FONT FACE="Times New Roman" SIZE=4>Владимир Козлов</font><FONT SIZE=4> &#9;</FONT><FONT FACE="Courier New" SIZE=2>(</FONT></b></i><A href="mailto:stm62@comset.net"><B><I><U><FONT FACE="Courier New" SIZE=2>mailto:stm62@comset.net</font></u></i></B></A><B><I><FONT FACE="Courier New" SIZE=2> ICQ/UIN 26870123</font></i></B><I>)</i></P><I>
<FONT FACE="Times New Roman" SIZE=4><P>Санкт-Петербург,</P>
<P>январь 2000</P>
</font></I> 
<P ALIGN="RIGHT"><SMALL><B> КЛУБ ПРОФЕССИОНАЛОВ "1С"<hr>
</b></small>
  </body>

</HTML>
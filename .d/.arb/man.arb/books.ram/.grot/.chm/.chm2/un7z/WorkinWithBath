<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=utf-8"><LINK href="v8help://service_book/service_style" type=text/css rel=stylesheet>
<META content="MSHTML 6.00.2900.3492" name=GENERATOR></HEAD>
<BODY>
<H1 class="">Работа с пакетными запросами</H1>
<P>Платформа 1С:Предприятие 8 позволяет работать с пакетами запросов. В пакетном запросе тексты запросов разделяются символом ";". Запросы исполняются последовательно, при этом временные таблицы, которые были созданы во время исполнения какого-либо запроса будут существовать до окончания исполнения всего пакета запроса или до исполнения в пакете запроса, уничтожающего данную временную таблицу. Например:</P>
<P>
<TABLE width="100%" bgColor=#f7f7f7>
<TBODY>
<TR>
<TD><FONT color=#ff0000><FONT face="Courier New"><FONT color=#0000ff>Запрос&nbsp;</FONT><FONT color=#ff0000>=</FONT><FONT color=#ff0000>&nbsp;Новый&nbsp;</FONT><FONT color=#0000ff>Запрос</FONT><FONT color=#ff0000>;</FONT><BR><FONT color=#0000ff>Запрос</FONT><FONT color=#ff0000>.</FONT><FONT color=#0000ff>Текст </FONT><FONT color=#ff0000>= </FONT></FONT><FONT face="Courier New"><FONT color=#000000>"ВЫБРАТЬ<BR>&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;УчетНоменклатурыОстаткиИОбороты.Номенклатура,<BR>&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;УчетНоменклатурыОстаткиИОбороты.КоличествоПриход,<BR>&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;УчетНоменклатурыОстаткиИОбороты.КоличествоРасход,<BR>&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;УчетНоменклатурыОстаткиИОбороты.КоличествоКонечныйОстаток<BR>&nbsp;&nbsp;&nbsp;&nbsp;|ПОМЕСТИТЬ&nbsp;УчетНоменклатуры<BR>&nbsp;&nbsp;&nbsp;&nbsp;|ИЗ<BR>&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;РегистрНакопления.УчетНоменклатуры.ОстаткиИОбороты(,&nbsp;,&nbsp;Авто,&nbsp;,&nbsp;)&nbsp;КАК&nbsp;УчетНоменклатурыОстаткиИОбороты<BR>&nbsp;&nbsp;&nbsp;&nbsp;|;<BR>&nbsp;&nbsp;&nbsp;&nbsp;|<BR>&nbsp;&nbsp;&nbsp;&nbsp;|ВЫБРАТЬ<BR>&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;УчетНоменклатуры.Номенклатура,<BR>&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;УчетНоменклатуры.КоличествоРасход,<BR>&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;УчетНоменклатуры.КоличествоКонечныйОстаток<BR>&nbsp;&nbsp;&nbsp;&nbsp;|ИЗ<BR>&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;УчетНоменклатуры&nbsp;КАК&nbsp;УчетНоменклатуры<BR>&nbsp;&nbsp;&nbsp;&nbsp;|"</FONT><FONT color=#ff0000>;</FONT><BR><BR><FONT color=#0000ff>Результат</FONT><FONT color=#ff0000>=</FONT><FONT color=#0000ff>Запрос</FONT><FONT color=#ff0000>.</FONT><FONT color=#0000ff>Выполнить</FONT><FONT color=#ff0000>(</FONT><FONT color=#ff0000>)</FONT><FONT color=#ff0000>;</FONT></FONT></FONT></TD></TR></TBODY></TABLE></P>
<P>Первый запрос создает временную таблицу, данные из которой используются во втором запросе.</P>
<P>Если объекту <FONT face="Courier New">Запрос</FONT>, исполняющему пакетный запрос, установлен менеджер временных таблиц, временные таблицы, которые не были уничтожены в рамках пакетного запроса, сохранятся в установленном менеджере. В тексте пакетного запроса возможно использование и уничтожение временных таблиц, которые существовали в установленном менеджере временных таблиц на момент запуска пакета на исполнение.</P>
<H2 class="">Метод ВыполнитьПакет()</H2>
<P>Кроме метода <A href="v8help://SyntaxHelperContext/objects/catalog213/catalog393/Query/methods/Execute564.html"><FONT face="Courier New">Выполнить()</FONT></A>, последовательно выполняющего все запросы пакета и возвращающего результат последнего запроса в пакете, платформа 1С:Предприятие 8 предоставляет еще один метод – <A href="v8help://SyntaxHelperContext/objects/catalog213/catalog393/Query/methods/ExecuteBatch3663.html"><FONT face="Courier New">ВыполнитьПакет()</FONT></A>. Этот метод последовательно выполняет все запросы и возвращает массив результатов для каждого запроса из пакета в последовательности расположения запросов в тексте пакета. Результатом выполнения запроса на уничтожение временной таблицы является значение Неопределено, которое также помещается в массив результатов.</P></BODY></HTML>
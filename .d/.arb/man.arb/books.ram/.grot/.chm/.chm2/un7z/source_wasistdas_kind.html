<HTML><HEAD>
<META content="text/html; charset=utf-8" http-equiv=Content-Type><LINK rel=stylesheet type=text/css href="v8help://service_book/service_style">
<META name=GENERATOR content="MSHTML 11.00.9600.19081"></HEAD>
<BODY>
<H1>Виды программных модулей</H1>
<BLOCKQUOTE style="MARGIN-RIGHT: 0px" dir=ltr>
<P><A href="#ManagedApplicationModule">Модуль приложения</A><BR><A href="#SessionModule">Модуль сеанса</A><BR><A href="#ExternalConnectionModule">Модуль внешнего соединения</A><BR><A href="#OrdinaryApplicationModule">Модуль обычного приложения</A><BR><A href="#CommonModules">Общие модули</A><BR><A href="#CommonObjectsModules">Модули общих объектов</A><BR><A href="#AppliedObjectsModules">Модули прикладных объектов</A><BR><A href="#ManageAppliedObjectsModules">Модули менеджеров прикладных объектов</A><BR><A href="#CommandsModules">Модули команд (модули общих команд)</A><BR><A href="#ManagedFormsModules">Модули управляемых форм</A><BR><A href="#FormsModules">Модули форм</A></P></BLOCKQUOTE>
<P>В системе 1С:Предприятие существуют несколько видов программных модулей. Они различаются по месту размещения и доступному контексту.</P>
<H3><A name=ManagedApplicationModule>Модуль приложения</A></H3>
<P>Модуль приложения располагается в корневом разделе конфигурации. В нем располагаются процедуры-обработчики событий, которые инициализируются при старте и окончании работы системы с установленном в&nbsp;значение "Управляемое приложение" свойства <STRONG>Основной режим запуска</STRONG>. В модуле управляемого приложения возможно объявление переменных, а также объявление и описание процедур и функций, которые будут доступны в любом модуле конфигурации (кроме модуля внешнего соединения). Их доступность также обеспечивается для неглобальных общих модулей с установленным свойством <STRONG>Клиент</STRONG>.&nbsp;В контексте модуля управляемого приложения доступны экспортируемые процедуры и функции общих модулей. </P>
<H3><A name=SessionModule>Модуль сеанса</A></H3>
<P>Модулем сеанса называется модуль, который автоматически выполняется при старте системы 1С:Предприятие 8 в момент загрузки конфигурации. </P>
<P>Модуль сеанса предназначен для инициализации параметров сеанса и отработки действий, связанных с сеансом работы. Модуль сеанса всегда исполняется в привилегированном режиме в кластере серверов 1С:Предприятия 8.</P>
<P><STRONG>Важно!</STRONG> Модуль сеанса может содержать только определения процедур и функций. </P>
<P>Модуль сеанса не содержит экспортируемых процедур и функций и может использовать процедуры из общих модулей конфигурации.</P>
<H3><A name=ExternalConnectionModule>Модуль внешнего соединения</A></H3>
<P>Модуль внешнего соединения расположен в корневом разделе конфигурации. В нем располагаются процедуры-обработчики событий, которые инициализируются при старте и окончании работы системы в режиме внешнего соединения (СОМ-соединения). </P>
<P>В модуле внешнего соединения возможно объявление переменных, а также объявление и описание процедур и функций, которые будут доступны для внешнего приложения, а также для неглобальных общих модулей с установленным свойством <STRONG>Внешнее соединение</STRONG>. </P>
<P>Объекты 1С:Предприятия, доступные извне через COM-соединение:</P>
<UL>
<LI>Экспортируемые переменные и процедуры/функции модуля внешнего соединения 
<LI>Экспортируемые процедуры/функции общих модулей 
<LI>Включение и исключение модулей целиком с помощью установки свойств общих модулей 
<LI>Включение и исключение фрагментов общих модулей с помощью препроцессора 
<LI>Глобальный контекст 1С:Предприятия 8 
<LI>За исключением объектов, жестко связанных с клиентским приложением (ТекстовыйДокумент, ТабличныйДокумент, ...)</LI></UL>
<P>Модуль присутствует только в сессии внешнего соединения.</P>
<P>В данном режиме характерно полное отсутствие пользовательского интерфейса.</P>
<H3><A name=OrdinaryApplicationModule>Модуль обычного приложения</A></H3>
<P>Модуль обычного приложения располагается в корневом разделе конфигурации. В нем располагаются процедуры-обработчики событий, которые инициализируются при старте и окончании работы системы с установленным в&nbsp;значение "<STRONG>Обычное приложение</STRONG>" свойством <STRONG>Основной режим запуска</STRONG>. В модуле обычного приложения возможно объявление переменных, а также объявление и описание процедур и функций, которые будут доступны в любом модуле конфигурации (кроме модуля внешнего соединения). Их доступность также обеспечивается для неглобальных общих модулей с установленным свойством <STRONG>Клиент (обычное приложение)</STRONG>.&nbsp;В контексте модуля обычного приложения доступны экспортируемые процедуры и функции общих модулей. </P>
<H3><A name=CommonModules>Общие модули</A></H3>
<P>Общие модули располагаются в отдельной ветке дерева метаданных. Основным назначением общих модулей является содержание общих алгоритмов конфигурации, доступных из разных модулей. В общих модулях отсутствует раздел определения переменных и раздел основной программы, то есть они содержат только раздел процедур и функций (см. раздел "<A href="v8help://SyntaxHelperCommonLanguage/source_format_struct.html">Структура программного модуля</A>"). </P>
<P>В любом общем модуле возможно объявление и описание процедур и функций, которые будут доступны в любом модуле конфигурации.</P>
<P>Если используется клиент–серверный вариант системы 1С:Предприятие 8, то с помощью свойств <STRONG>Клиент (обычное приложение)</STRONG>, <STRONG>Клиент </STRONG>и <STRONG>Сервер</STRONG>, а также инструкций препроцессора можно организовывать выполнение различных процедур и функций общих модулей на сервере приложения или на клиентском месте.</P>
<P>Если установлено свойство <STRONG>Клиент (обычное приложение) </STRONG>или <STRONG>Клиент</STRONG>, то все процедуры и функции общего модуля могут использоваться в клиентском приложении. <BR>В контексте неглобального общего модуля с установленным свойством <STRONG>Клиент (обычное приложение)&nbsp;</STRONG>доступны экспортируемые переменные, процедуры и функции модуля обычного приложения. <BR>В контексте неглобального общего модуля с установленным свойством <STRONG>Клиент</STRONG>&nbsp;доступны экспортируемые переменные, процедуры и функции модуля управляемого приложения.</P>
<P><STRONG>Важно! </STRONG>Свойство <STRONG>Клиент (обычное приложение)</STRONG>&nbsp;показывается, если в <A href="v8help://config/form_configeditforrunmode"><FONT color=#800080>настройках конфигурации</FONT></A> режима запуска установлен режим&nbsp;"<STRONG>Управляемое приложение и обычное приложение</STRONG>".</P>
<P>Если установлено свойство <STRONG>Сервер</STRONG>, то все процедуры и функции общего модуля могут использоваться в клиент-серверном варианте.</P>
<P>Если предполагается, что процедуры и функции общего модуля могут быть использованы во внешнем соединении, то следует установить свойство <STRONG>Внешнее соединение</STRONG>. <BR>В контексте неглобального общего модуля с установленным свойством <STRONG>Внешнее соединение </STRONG>доступны экспортируемые переменные, процедуры и функции модуля внешнего соединения.</P>
<P>Свойство <STRONG>Вызов сервера</STRONG> разрешает вызов сервера. Свойство доступно, если установлено свойство <STRONG>Сервер</STRONG>. Если не установлено, то процедуры и функции данного модуля доступны только на сервере. Если установлено, то процедуры и функции данного модуля доступны на клиенте.</P>
<P>Свойство <STRONG>Привилегированный</STRONG> предназначено для установки полных прав доступа при выполнении действий с базой данных в процедурах и функциях общего модуля. При установленном свойстве выполнение производится только на сервере. </P>
<P><STRONG>Повторное использование возвращаемых значений</STRONG>. Свойство доступно, если общий модуль не является <STRONG>Глобальным</STRONG>. Это свойство может принимать следующие значения:</P>
<UL>
<LI><STRONG>Не использовать</STRONG> – повторное использование возвращаемых значений для функций этого общего модуля не используется; 
<LI><STRONG>На время вызова</STRONG> и <STRONG>На время сеанса</STRONG> – для общего&nbsp; модуля используется метод определения повторного использования данных. Суть этого метода заключается в том, что в ходе выполнения кода система запоминает параметры и результат работы функций после первого вызова функции. При повторном вызове функции с такими же параметрами, происходит возврат запомненного значения (из первого вызова) без выполнения самой функции. Если функция во время своего выполнения меняет значения параметров, то повторный вызов функции не будет это делать.</LI></UL>
<P>Можно выделить следующие особенности сохранения результатов вызова:</P>
<UL>
<LI>если функция выполняется на сервере и вызывается из серверного кода, то значения параметров и результат вызова запоминаются&nbsp; для текущего сеанса на стороне сервера; 
<LI>если функция выполняется на толстом или тонком клиенте, то значения параметров и результатов вызова запоминается на стороне клиента; 
<LI>если функция выполняется на стороне сервера, а вызывается из клиентского кода, то значения параметров вызова запоминаются и на стороне клиента и на стороне сервера.</LI></UL>
<P>Сохраненные значения удаляются:</P>
<UL>
<LI>если свойство установлено в значение <STRONG>На время вызова</STRONG>: 
<UL>
<LI>на стороне сервера – при возврате управления с сервера; 
<LI>на стороне клиента – при завершении работы процедуры или функции встроенного языка&nbsp; верхнего уровня (вызванной системой из интерфейса, а не из другой процедуры или функции встроенного языка).</LI></UL>
<LI>если свойство общего модуля установлено в значение На время сеанса: 
<UL>
<LI>на стороне сервера – при окончании сеанса; 
<LI>на стороне клиента – при закрытии клиентского приложения.</LI></UL></LI></UL>
<P>Сохраненные значения могут быть удалены:</P>
<UL>
<LI>после долгого неиспользования (более 5 минут); 
<LI>при нехватке оперативной памяти в рабочем процессе сервера; 
<LI>при перезапуске рабочего процесса; 
<LI>при переключении клиента на другой рабочий процесс.</LI></UL>
<P>После удаления значений, вызов экспортной функции выполняется как при первом вызове.<BR></P>
<P class=Usual>Свойство <STRONG>Глобальный</STRONG> определяет, являются ли экспортируемые методы общего модуля частью глобального контекста. <BR>Если свойство <STRONG>Глобальный</STRONG> установлено в значение <STRONG>Истина</STRONG>, то экспортируемые методы общего модуля доступны как методы глобального контекста.</P>
<P>Если свойство <STRONG>Глобальный</STRONG> установлено в значение Ложь, то в глобальном контексте создается свойство с именем, соответствующим имени общего модуля в метаданных. Данное свойство доступно <STRONG>ТОЛЬКО</STRONG> для чтения. Значением данного свойства является объект <EM>ОбщийМодуль</EM>. Через данный объект доступны экспортируемые методы данного общего модуля. Таким образом, обращение к методам неглобальных общих модулей выглядит как XXXXX.YYYYY, где XXXXX – это имя свойства общего модуля, а YYYYY – имя экспортируемого метода общего модуля.</P>
<P>Если установлено свойство <STRONG>Клиент (обычное</STRONG> <STRONG>приложение)</STRONG>, то модуль загружается в толстом клиенте в режиме обычного приложения. </P>
<P>Если установлено свойство <STRONG>Клиент</STRONG>, то все процедуры и функции общего модуля могут использоваться в режиме Управляемое приложения, в тонком клиенте, в веб-клиенте. </P>
<P>Модули с&nbsp;установленным свойством <STRONG>Клиент (обычное</STRONG> <STRONG>приложение)</STRONG>, проверяются для режимов запуска:</P>
<UL>
<LI>Толстый клиент (обычное приложение); 
<LI>Толстый клиент (обычное приложение) вариант клиент-сервер.</LI></UL>
<P>Модули с&nbsp;установленным свойством <STRONG>Клиент</STRONG>, проверяются для режимов запуска:</P>
<UL>
<LI>Толстый клиент (управляемое приложение); 
<LI>Толстый клиент (управляемое приложение) вариант клиент-сервер; 
<LI>Тонкий клиент; 
<LI>Веб-клиент.</LI></UL>
<H3><A name=CommonObjectsModules>Модули общих объектов</A></H3>
<P>Некоторые&nbsp;общие объекты имеют собственные модули. К таким объектам относятся:</P>
<UL>
<LI>Команды; 
<LI>Web-сервисы. </LI></UL>
<P class=Usual>Модули располагаются в ветках конфигурации, в которых содержатся сами объекты и являются свойствами объектов. Каждый объект имеет свой индивидуальный модуль. В этих модулях возможно объявление переменных, процедур и функций, которые будут доступны при работе с объектом извне во встроенном языке, дополняя контекст объекта.</P>
<H3><A name=AppliedObjectsModules>Модули прикладных</A> объектов</H3>
<P>Набор прикладных объектов имеет собственные модули. К таким объектам относятся:</P>
<UL>
<LI>менеджеры значения константы; 
<LI>справочники; 
<LI>документы; 
<LI>отчеты (внешние отчеты); 
<LI>обработки (внешние обработки); 
<LI>планы видов характеристик; 
<LI>планы счетов; 
<LI>планы видов расчетов; 
<LI>бизнес-процессы; 
<LI>задачи; 
<LI>регистры.</LI></UL>
<P class=Usual>Модули располагаются в ветках конфигурации, в которых содержатся сами объекты и являются свойствами объектов. Каждый объект имеет свой индивидуальный модуль. В этих модулях возможно объявление переменных, процедур и функций, которые будут доступны при работе с объектом извне во встроенном языке, дополняя контекст объекта. </P>
<P>В контексте модуля прикладного объекта есть доступ к реквизитам и табличным частям объекта, а также его методам и событиям. </P>
<H3><A name=ManageAppliedObjectsModules>Модули менеджеров</A> прикладных объектов</H3>
<P>Каждый прикладной объект имеет менеджер, предназначенный для управления этим объектом, как объектом конфигурации. С помощью менеджера можно создавать объекты, работать с формами и макетами. Модуль менеджера позволяет расширить функциональность менеджеров за счет введения процедур и функций на встроенном языке. Фактически, это позволяет описать методы для объекта конфигурации (например, справочника), которые относятся не к конкретному экземпляру объекта базы данных, а к самому объекту конфигурации.<BR>Контекст модуля менеджера образуется из:</P>
<UL>
<LI>глобального контекста, в том числе экспортируемых функций общих модулей (если для модулей установлено&nbsp;свойство <STRONG>Клиент (обычное приложение)</STRONG>, <STRONG>Клиент</STRONG> или <STRONG>Сервер</STRONG>); 
<LI>экспортируемых переменных, процедур и функций модулей управляемого или обычного приложений; 
<LI>локальных и экспортируемых функций самого модуля.</LI></UL>
<P>Модуль менеджера не может иметь переменных и тела модуля.</P>
<P>Если функции или процедуры модуля менеджера объявлены как экспортируемые, к ним можно будет получить доступ через менеджер объекта.</P>
<P><STRONG>Пример</STRONG>:<BR>Модуль менеджера:<BR>
<TABLE width="100%" bgColor=#f7f7f7>
<TBODY>
<TR>
<TD><FONT color=#ff0000><FONT face="Courier New">Функция&nbsp;<FONT color=#0000ff>ПолучитьСписокДебиторов</FONT><FONT color=#ff0000>(</FONT><FONT color=#ff0000>)</FONT><FONT color=#ff0000>&nbsp;Экспорт</FONT><BR></FONT><FONT face="Courier New"><FONT color=#0000ff>…<BR></FONT><FONT color=#ff0000>КонецФункции</FONT></FONT></FONT></TD></TR></TBODY></TABLE></P>
<P>Вызов из прикладного кода:<BR>
<TABLE width="100%" bgColor=#f7f7f7>
<TBODY>
<TR>
<TD><FONT color=#ff0000><FONT face="Courier New"><FONT color=#0000ff>Дебиторы&nbsp;</FONT><FONT color=#ff0000>=</FONT><FONT color=#0000ff>&nbsp;Справочники</FONT><FONT color=#ff0000>.</FONT><FONT color=#0000ff>Контрагент</FONT><FONT color=#ff0000>.</FONT><FONT color=#0000ff>&nbsp;ПолучитьСписокДебиторов</FONT><FONT color=#ff0000>(</FONT><FONT color=#ff0000>)</FONT><FONT color=#ff0000>;</FONT></FONT></FONT></TD></TR></TBODY></TABLE></P>
<H3><A name=CommandsModules>Модули команд (модули общих команд)</A></H3>
<P>Для нестандартных команд требуется написать процедуру ее выполнения. Для этого служит модуль команды, в котором можно написать предопределенную процедуру ОбработатьКоманду(). Данная процедура должна предваряться <A href="v8help://SyntaxHelperLanguage/Pragma">директивой компиляции</A> <STRONG>&amp;НаКлиенте</STRONG>, так как выполнение команды происходит в клиентском приложении.</P>
<H3><A name=ManagedFormsModules>Модули управляемых форм</A> </H3>
<P>Модуль состоит из набора процедур и функций. Переменные модуля и тело модуля не допускаются. </P>
<H3><A name=FormsModules>Модули форм</A></H3>
<P>Эти модули содержатся в формах конфигурации. Каждая форма имеет свой индивидуальный модуль. В этих модулях возможно объявление переменных, процедур и функций, которые будут доступны при работе с формой извне во встроенном языке, дополняя контекст формы.</P>
<P>В контексте модуля формы доступны реквизиты формы, а также ее свойства, методы и события. Если у формы назначен основной реквизит, то в модуле формы становятся доступны свойства и методы прикладного объекта, используемого в качестве основного реквизита.</P></BODY></HTML>